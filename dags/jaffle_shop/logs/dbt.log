[0m15:50:27.986246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb2c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f38ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f39190>]}


============================== 15:50:27.995350 | de091c6a-5219-4837-8613-c48356a2caeb ==============================
[0m15:50:27.995350 [info ] [MainThread]: Running with dbt=1.7.7
[0m15:50:27.995837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:50:27.996323 [info ] [MainThread]: dbt version: 1.7.7
[0m15:50:27.996590 [info ] [MainThread]: python version: 3.11.6
[0m15:50:27.996842 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m15:50:27.997067 [info ] [MainThread]: os info: macOS-14.3-arm64-arm-64bit
[0m15:50:28.115235 [error] [MainThread]: Encountered an error:
dlopen(/opt/homebrew/lib/python3.11/site-packages/pyodbc.cpython-311-darwin.so, 0x0002): symbol not found in flat namespace '_SQLAllocHandle'
[0m15:50:28.140860 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/main.py", line 444, in debug
    results = task.run()
              ^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/debug.py", line 123, in run
    load_profile_status: SubtaskStatus = self._load_profile()
                                         ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/debug.py", line 212, in _load_profile
    profile: Profile = Profile.render(
                       ^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 436, in render
    return cls.from_raw_profiles(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 401, in from_raw_profiles
    return cls.from_raw_profile_info(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 355, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 165, in _credentials_from_profile
    cls = load_plugin(typename)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/factory.py", line 212, in load_plugin
    return FACTORY.load_plugin(name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/factory.py", line 58, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/fabric/__init__.py", line 3, in <module>
    from dbt.adapters.fabric.fabric_adapter import FabricAdapter
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/fabric/fabric_adapter.py", line 24, in <module>
    from dbt.adapters.fabric.fabric_connection_manager import FabricConnectionManager
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 10, in <module>
    import pyodbc
ImportError: dlopen(/opt/homebrew/lib/python3.11/site-packages/pyodbc.cpython-311-darwin.so, 0x0002): symbol not found in flat namespace '_SQLAllocHandle'

[0m15:50:28.149678 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.22803292, "process_user_time": 1.886943, "process_kernel_time": 0.521732, "process_mem_max_rss": "109428736", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:50:28.150735 [debug] [MainThread]: Command `dbt debug` failed at 15:50:28.150526 after 0.23 seconds
[0m15:50:28.151445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b17550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067864d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b07190>]}
[0m15:50:28.152016 [debug] [MainThread]: Flushing usage events
[0m15:52:36.426629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c1710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107538d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107539410>]}


============================== 15:52:36.435424 | 82bd870a-dad6-4fa1-b465-3ba220cbd233 ==============================
[0m15:52:36.435424 [info ] [MainThread]: Running with dbt=1.7.7
[0m15:52:36.435922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:52:36.436397 [info ] [MainThread]: dbt version: 1.7.7
[0m15:52:36.436664 [info ] [MainThread]: python version: 3.11.6
[0m15:52:36.436913 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m15:52:36.437143 [info ] [MainThread]: os info: macOS-14.3-arm64-arm-64bit
[0m15:52:36.473548 [error] [MainThread]: Encountered an error:
dlopen(/opt/homebrew/lib/python3.11/site-packages/pyodbc.cpython-311-darwin.so, 0x0002): symbol not found in flat namespace '_SQLAllocHandle'
[0m15:52:36.511894 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/main.py", line 444, in debug
    results = task.run()
              ^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/debug.py", line 123, in run
    load_profile_status: SubtaskStatus = self._load_profile()
                                         ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/debug.py", line 212, in _load_profile
    profile: Profile = Profile.render(
                       ^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 436, in render
    return cls.from_raw_profiles(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 401, in from_raw_profiles
    return cls.from_raw_profile_info(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 355, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 165, in _credentials_from_profile
    cls = load_plugin(typename)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/factory.py", line 212, in load_plugin
    return FACTORY.load_plugin(name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/factory.py", line 58, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/fabric/__init__.py", line 3, in <module>
    from dbt.adapters.fabric.fabric_adapter import FabricAdapter
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/fabric/fabric_adapter.py", line 24, in <module>
    from dbt.adapters.fabric.fabric_connection_manager import FabricConnectionManager
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 10, in <module>
    import pyodbc
ImportError: dlopen(/opt/homebrew/lib/python3.11/site-packages/pyodbc.cpython-311-darwin.so, 0x0002): symbol not found in flat namespace '_SQLAllocHandle'

[0m15:52:36.515997 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.16387254, "process_user_time": 1.695653, "process_kernel_time": 0.47194, "process_mem_max_rss": "109051904", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:52:36.516501 [debug] [MainThread]: Command `dbt debug` failed at 15:52:36.516398 after 0.16 seconds
[0m15:52:36.516808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075391d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10065f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1006d7690>]}
[0m15:52:36.517126 [debug] [MainThread]: Flushing usage events
[0m15:54:14.221156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a53dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a34fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a87250>]}


============================== 15:54:14.227610 | 11efdae5-7140-42a7-9899-4670de3c72d8 ==============================
[0m15:54:14.227610 [info ] [MainThread]: Running with dbt=1.7.7
[0m15:54:14.228126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/logs', 'debug': 'False', 'profiles_dir': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:54:14.228623 [info ] [MainThread]: dbt version: 1.7.7
[0m15:54:14.228889 [info ] [MainThread]: python version: 3.11.6
[0m15:54:14.229147 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m15:54:14.229377 [info ] [MainThread]: os info: macOS-14.3-arm64-arm-64bit
[0m15:54:14.249800 [error] [MainThread]: Encountered an error:
dlopen(/opt/homebrew/lib/python3.11/site-packages/pyodbc.cpython-311-darwin.so, 0x0002): symbol not found in flat namespace '_SQLAllocHandle'
[0m15:54:14.257850 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/main.py", line 444, in debug
    results = task.run()
              ^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/debug.py", line 123, in run
    load_profile_status: SubtaskStatus = self._load_profile()
                                         ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/debug.py", line 212, in _load_profile
    profile: Profile = Profile.render(
                       ^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 436, in render
    return cls.from_raw_profiles(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 401, in from_raw_profiles
    return cls.from_raw_profile_info(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 355, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 165, in _credentials_from_profile
    cls = load_plugin(typename)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/factory.py", line 212, in load_plugin
    return FACTORY.load_plugin(name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/factory.py", line 58, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/fabric/__init__.py", line 3, in <module>
    from dbt.adapters.fabric.fabric_adapter import FabricAdapter
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/fabric/fabric_adapter.py", line 24, in <module>
    from dbt.adapters.fabric.fabric_connection_manager import FabricConnectionManager
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 10, in <module>
    import pyodbc
ImportError: dlopen(/opt/homebrew/lib/python3.11/site-packages/pyodbc.cpython-311-darwin.so, 0x0002): symbol not found in flat namespace '_SQLAllocHandle'

[0m15:54:14.260134 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.08653129, "process_user_time": 1.327453, "process_kernel_time": 0.296402, "process_mem_max_rss": "106545152", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:54:14.260633 [debug] [MainThread]: Command `dbt debug` failed at 15:54:14.260533 after 0.09 seconds
[0m15:54:14.260949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fe7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aaf550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aacc90>]}
[0m15:54:14.261251 [debug] [MainThread]: Flushing usage events
[0m15:55:11.731377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f3450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105828ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058291d0>]}


============================== 15:55:11.736593 | 66abc8c0-cc68-4bef-b0c7-066171d32130 ==============================
[0m15:55:11.736593 [info ] [MainThread]: Running with dbt=1.7.7
[0m15:55:11.737107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:55:11.737596 [info ] [MainThread]: dbt version: 1.7.7
[0m15:55:11.737873 [info ] [MainThread]: python version: 3.11.6
[0m15:55:11.738130 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m15:55:11.738361 [info ] [MainThread]: os info: macOS-14.3-arm64-arm-64bit
[0m15:55:11.751948 [error] [MainThread]: Encountered an error:
dlopen(/opt/homebrew/lib/python3.11/site-packages/pyodbc.cpython-311-darwin.so, 0x0002): symbol not found in flat namespace '_SQLAllocHandle'
[0m15:55:11.758460 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/main.py", line 444, in debug
    results = task.run()
              ^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/debug.py", line 123, in run
    load_profile_status: SubtaskStatus = self._load_profile()
                                         ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/debug.py", line 212, in _load_profile
    profile: Profile = Profile.render(
                       ^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 436, in render
    return cls.from_raw_profiles(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 401, in from_raw_profiles
    return cls.from_raw_profile_info(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 355, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 165, in _credentials_from_profile
    cls = load_plugin(typename)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/factory.py", line 212, in load_plugin
    return FACTORY.load_plugin(name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/factory.py", line 58, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/fabric/__init__.py", line 3, in <module>
    from dbt.adapters.fabric.fabric_adapter import FabricAdapter
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/fabric/fabric_adapter.py", line 24, in <module>
    from dbt.adapters.fabric.fabric_connection_manager import FabricConnectionManager
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 10, in <module>
    import pyodbc
ImportError: dlopen(/opt/homebrew/lib/python3.11/site-packages/pyodbc.cpython-311-darwin.so, 0x0002): symbol not found in flat namespace '_SQLAllocHandle'

[0m15:55:11.760966 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.075644, "process_user_time": 1.32247, "process_kernel_time": 0.237197, "process_mem_max_rss": "106725376", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:55:11.761426 [debug] [MainThread]: Command `dbt debug` failed at 15:55:11.761330 after 0.08 seconds
[0m15:55:11.761717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d63550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10582a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058295d0>]}
[0m15:55:11.762020 [debug] [MainThread]: Flushing usage events
[0m15:59:37.061612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10592d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105988750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105988e50>]}


============================== 15:59:37.076078 | 020de132-3e61-4546-b22d-6aa7bd14da04 ==============================
[0m15:59:37.076078 [info ] [MainThread]: Running with dbt=1.7.7
[0m15:59:37.076577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/logs', 'version_check': 'True', 'profiles_dir': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:59:37.077082 [info ] [MainThread]: dbt version: 1.7.7
[0m15:59:37.077353 [info ] [MainThread]: python version: 3.11.6
[0m15:59:37.077603 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m15:59:37.077827 [info ] [MainThread]: os info: macOS-14.3-arm64-arm-64bit
[0m15:59:37.096067 [error] [MainThread]: Encountered an error:
dlopen(/opt/homebrew/lib/python3.11/site-packages/pyodbc.cpython-311-darwin.so, 0x0002): symbol not found in flat namespace '_SQLAllocHandle'
[0m15:59:37.103526 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/main.py", line 444, in debug
    results = task.run()
              ^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/debug.py", line 123, in run
    load_profile_status: SubtaskStatus = self._load_profile()
                                         ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/debug.py", line 212, in _load_profile
    profile: Profile = Profile.render(
                       ^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 436, in render
    return cls.from_raw_profiles(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 401, in from_raw_profiles
    return cls.from_raw_profile_info(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 355, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/config/profile.py", line 165, in _credentials_from_profile
    cls = load_plugin(typename)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/factory.py", line 212, in load_plugin
    return FACTORY.load_plugin(name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/factory.py", line 58, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/fabric/__init__.py", line 3, in <module>
    from dbt.adapters.fabric.fabric_adapter import FabricAdapter
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/fabric/fabric_adapter.py", line 24, in <module>
    from dbt.adapters.fabric.fabric_connection_manager import FabricConnectionManager
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 10, in <module>
    import pyodbc
ImportError: dlopen(/opt/homebrew/lib/python3.11/site-packages/pyodbc.cpython-311-darwin.so, 0x0002): symbol not found in flat namespace '_SQLAllocHandle'

[0m15:59:37.105995 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.109154455, "process_user_time": 1.33375, "process_kernel_time": 0.304025, "process_mem_max_rss": "107479040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:59:37.106545 [debug] [MainThread]: Command `dbt debug` failed at 15:59:37.106436 after 0.11 seconds
[0m15:59:37.106854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ec3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105841510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599edd0>]}
[0m15:59:37.107162 [debug] [MainThread]: Flushing usage events
[0m16:02:13.186693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034acd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105313d60>]}


============================== 16:02:13.197587 | 3d86c841-efcd-4349-ae6e-0b8e02450888 ==============================
[0m16:02:13.197587 [info ] [MainThread]: Running with dbt=1.7.7
[0m16:02:13.198154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:02:13.198718 [info ] [MainThread]: dbt version: 1.7.7
[0m16:02:13.199034 [info ] [MainThread]: python version: 3.9.6
[0m16:02:13.199323 [info ] [MainThread]: python path: /Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/bin/python3
[0m16:02:13.199609 [info ] [MainThread]: os info: macOS-14.3-arm64-arm-64bit
[0m16:02:13.322982 [error] [MainThread]: Encountered an error:
dlopen(/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/pyodbc.cpython-39-darwin.so, 0x0002): symbol not found in flat namespace '_SQLAllocHandle'
[0m16:02:13.356979 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/cli/main.py", line 444, in debug
    results = task.run()
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/task/debug.py", line 123, in run
    load_profile_status: SubtaskStatus = self._load_profile()
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/task/debug.py", line 212, in _load_profile
    profile: Profile = Profile.render(
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/config/profile.py", line 436, in render
    return cls.from_raw_profiles(
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/config/profile.py", line 401, in from_raw_profiles
    return cls.from_raw_profile_info(
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/config/profile.py", line 355, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/config/profile.py", line 165, in _credentials_from_profile
    cls = load_plugin(typename)
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/factory.py", line 212, in load_plugin
    return FACTORY.load_plugin(name)
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/factory.py", line 58, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/fabric/__init__.py", line 3, in <module>
    from dbt.adapters.fabric.fabric_adapter import FabricAdapter
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_adapter.py", line 24, in <module>
    from dbt.adapters.fabric.fabric_connection_manager import FabricConnectionManager
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 10, in <module>
    import pyodbc
ImportError: dlopen(/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/pyodbc.cpython-39-darwin.so, 0x0002): symbol not found in flat namespace '_SQLAllocHandle'

[0m16:02:13.394032 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.28126332, "process_user_time": 2.410798, "process_kernel_time": 0.514804, "process_mem_max_rss": "97894400", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:02:13.394721 [debug] [MainThread]: Command `dbt debug` failed at 16:02:13.394580 after 0.28 seconds
[0m16:02:13.395099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034acd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105391eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053267f0>]}
[0m16:02:13.395476 [debug] [MainThread]: Flushing usage events
[0m16:03:05.930543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ac370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669bf10>]}


============================== 16:03:05.938158 | 7de00d35-c4a8-4dc7-bcc4-8ea5eff9cb38 ==============================
[0m16:03:05.938158 [info ] [MainThread]: Running with dbt=1.7.7
[0m16:03:05.938744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:03:05.941369 [info ] [MainThread]: Setting up your profile.
[0m16:03:13.672534 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 7.8050194, "process_user_time": 1.804442, "process_kernel_time": 0.241284, "process_mem_max_rss": "93585408", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:03:13.674569 [debug] [MainThread]: Command `dbt init` succeeded at 16:03:13.674274 after 7.81 seconds
[0m16:03:13.675385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10668be50>]}
[0m16:03:13.676132 [debug] [MainThread]: Flushing usage events
[0m16:03:20.187915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e8dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106997190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c2ac0>]}


============================== 16:03:20.192821 | 5b5a9edc-8601-45b2-a968-627c685e30da ==============================
[0m16:03:20.192821 [info ] [MainThread]: Running with dbt=1.7.7
[0m16:03:20.193373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop', 'log_path': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:03:20.214040 [error] [MainThread]: Encountered an error:
dlopen(/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/pyodbc.cpython-39-darwin.so, 0x0002): symbol not found in flat namespace '_SQLAllocHandle'
[0m16:03:20.245136 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 166, in wrapper
    profile = load_profile(flags.PROJECT_DIR, flags.VARS, flags.PROFILE, flags.TARGET, threads)
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/config/runtime.py", line 70, in load_profile
    profile = Profile.render(
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/config/profile.py", line 436, in render
    return cls.from_raw_profiles(
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/config/profile.py", line 401, in from_raw_profiles
    return cls.from_raw_profile_info(
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/config/profile.py", line 355, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/config/profile.py", line 165, in _credentials_from_profile
    cls = load_plugin(typename)
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/factory.py", line 212, in load_plugin
    return FACTORY.load_plugin(name)
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/factory.py", line 58, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/fabric/__init__.py", line 3, in <module>
    from dbt.adapters.fabric.fabric_adapter import FabricAdapter
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_adapter.py", line 24, in <module>
    from dbt.adapters.fabric.fabric_connection_manager import FabricConnectionManager
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 10, in <module>
    import pyodbc
ImportError: dlopen(/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/pyodbc.cpython-39-darwin.so, 0x0002): symbol not found in flat namespace '_SQLAllocHandle'

[0m16:03:20.246973 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.12688525, "process_user_time": 1.820632, "process_kernel_time": 0.221246, "process_mem_max_rss": "92635136", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:03:20.247532 [debug] [MainThread]: Command `dbt run` failed at 16:03:20.247406 after 0.13 seconds
[0m16:03:20.247888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e8dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a39340>]}
[0m16:03:20.248251 [debug] [MainThread]: Flushing usage events
[0m16:09:51.627774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107844b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195a2370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119591f10>]}


============================== 16:09:51.638715 | 0c4a7976-ccf3-4439-b375-8b1fcfd2cc1d ==============================
[0m16:09:51.638715 [info ] [MainThread]: Running with dbt=1.7.7
[0m16:09:51.639318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop', 'log_path': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:09:51.639898 [info ] [MainThread]: dbt version: 1.7.7
[0m16:09:51.640210 [info ] [MainThread]: python version: 3.9.6
[0m16:09:51.640535 [info ] [MainThread]: python path: /Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/bin/python3
[0m16:09:51.640840 [info ] [MainThread]: os info: macOS-14.3-arm64-arm-64bit
[0m16:09:51.735522 [debug] [MainThread]: Traceback (most recent call last):
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/factory.py", line 58, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/fabric/__init__.py", line 3, in <module>
    from dbt.adapters.fabric.fabric_adapter import FabricAdapter
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_adapter.py", line 24, in <module>
    from dbt.adapters.fabric.fabric_connection_manager import FabricConnectionManager
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 10, in <module>
    import pyodbc
ModuleNotFoundError: No module named 'pyodbc'

[0m16:09:51.736111 [error] [MainThread]: Encountered an error:
No module named 'pyodbc'
[0m16:09:51.780717 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/cli/main.py", line 444, in debug
    results = task.run()
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/task/debug.py", line 123, in run
    load_profile_status: SubtaskStatus = self._load_profile()
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/task/debug.py", line 212, in _load_profile
    profile: Profile = Profile.render(
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/config/profile.py", line 436, in render
    return cls.from_raw_profiles(
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/config/profile.py", line 401, in from_raw_profiles
    return cls.from_raw_profile_info(
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/config/profile.py", line 355, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/config/profile.py", line 165, in _credentials_from_profile
    cls = load_plugin(typename)
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/factory.py", line 212, in load_plugin
    return FACTORY.load_plugin(name)
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/factory.py", line 58, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/fabric/__init__.py", line 3, in <module>
    from dbt.adapters.fabric.fabric_adapter import FabricAdapter
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_adapter.py", line 24, in <module>
    from dbt.adapters.fabric.fabric_connection_manager import FabricConnectionManager
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 10, in <module>
    import pyodbc
ModuleNotFoundError: No module named 'pyodbc'

[0m16:09:51.825933 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.28716633, "process_user_time": 2.417707, "process_kernel_time": 0.523367, "process_mem_max_rss": "94912512", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:09:51.826642 [debug] [MainThread]: Command `dbt debug` failed at 16:09:51.826486 after 0.29 seconds
[0m16:09:51.827028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107844b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195444c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195e3cd0>]}
[0m16:09:51.827427 [debug] [MainThread]: Flushing usage events
[0m16:12:54.803283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c2cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084fae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e9ca0>]}


============================== 16:12:54.808921 | 719ca359-1156-4270-a755-a27e66843eff ==============================
[0m16:12:54.808921 [info ] [MainThread]: Running with dbt=1.7.7
[0m16:12:54.809456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/logs', 'version_check': 'True', 'profiles_dir': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m16:12:54.810002 [info ] [MainThread]: dbt version: 1.7.7
[0m16:12:54.810321 [info ] [MainThread]: python version: 3.9.6
[0m16:12:54.810617 [info ] [MainThread]: python path: /Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/bin/python3
[0m16:12:54.810905 [info ] [MainThread]: os info: macOS-14.3-arm64-arm-64bit
[0m16:12:54.962123 [error] [MainThread]: Encountered an error:
dlopen(/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/pyodbc.cpython-39-darwin.so, 0x0002): symbol not found in flat namespace '_SQLAllocHandle'
[0m16:12:54.997407 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/cli/main.py", line 444, in debug
    results = task.run()
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/task/debug.py", line 123, in run
    load_profile_status: SubtaskStatus = self._load_profile()
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/task/debug.py", line 212, in _load_profile
    profile: Profile = Profile.render(
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/config/profile.py", line 436, in render
    return cls.from_raw_profiles(
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/config/profile.py", line 401, in from_raw_profiles
    return cls.from_raw_profile_info(
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/config/profile.py", line 355, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/config/profile.py", line 165, in _credentials_from_profile
    cls = load_plugin(typename)
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/factory.py", line 212, in load_plugin
    return FACTORY.load_plugin(name)
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/factory.py", line 58, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
  File "/Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/fabric/__init__.py", line 3, in <module>
    from dbt.adapters.fabric.fabric_adapter import FabricAdapter
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_adapter.py", line 24, in <module>
    from dbt.adapters.fabric.fabric_connection_manager import FabricConnectionManager
  File "/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 10, in <module>
    import pyodbc
ImportError: dlopen(/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/lib/python3.9/site-packages/pyodbc.cpython-39-darwin.so, 0x0002): symbol not found in flat namespace '_SQLAllocHandle'

[0m16:12:55.023808 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.30530846, "process_user_time": 1.839955, "process_kernel_time": 0.25349, "process_mem_max_rss": "91947008", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:12:55.024455 [debug] [MainThread]: Command `dbt debug` failed at 16:12:55.024313 after 0.31 seconds
[0m16:12:55.024826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c2cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108566820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108566730>]}
[0m16:12:55.025201 [debug] [MainThread]: Flushing usage events
[0m16:23:55.035660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c2ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c62e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c50ca0>]}


============================== 16:23:55.049826 | b1c148ac-e277-4f40-9278-66236601cf57 ==============================
[0m16:23:55.049826 [info ] [MainThread]: Running with dbt=1.7.7
[0m16:23:55.050388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:23:55.050956 [info ] [MainThread]: dbt version: 1.7.7
[0m16:23:55.051268 [info ] [MainThread]: python version: 3.9.6
[0m16:23:55.051561 [info ] [MainThread]: python path: /Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/.venv/bin/python3
[0m16:23:55.051850 [info ] [MainThread]: os info: macOS-14.3-arm64-arm-64bit
[0m16:23:57.053281 [info ] [MainThread]: Using profiles dir at /Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop
[0m16:23:57.053750 [info ] [MainThread]: Using profiles.yml file at /Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/profiles.yml
[0m16:23:57.054078 [info ] [MainThread]: Using dbt_project.yml file at /Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/dbt_project.yml
[0m16:23:57.054398 [info ] [MainThread]: adapter type: fabric
[0m16:23:57.054693 [info ] [MainThread]: adapter version: 1.7.4
[0m16:23:57.124156 [info ] [MainThread]: Configuration:
[0m16:23:57.124621 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:23:57.124955 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:23:57.125250 [info ] [MainThread]: Required dependencies:
[0m16:23:57.125643 [debug] [MainThread]: Executing "git --help"
[0m16:23:57.150480 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:23:57.151891 [debug] [MainThread]: STDERR: "b''"
[0m16:23:57.152552 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:23:57.153016 [info ] [MainThread]: Connection:
[0m16:23:57.153441 [info ] [MainThread]:   server: x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com
[0m16:23:57.153759 [info ] [MainThread]:   database: fabric-database
[0m16:23:57.154044 [info ] [MainThread]:   schema: dbo
[0m16:23:57.154321 [info ] [MainThread]:   UID: None
[0m16:23:57.154622 [info ] [MainThread]:   client_id: None
[0m16:23:57.154902 [info ] [MainThread]:   authentication: CLI
[0m16:23:57.155178 [info ] [MainThread]:   encrypt: True
[0m16:23:57.155455 [info ] [MainThread]:   trust_cert: False
[0m16:23:57.155727 [info ] [MainThread]:   retries: 1
[0m16:23:57.155999 [info ] [MainThread]:   login_timeout: 0
[0m16:23:57.156269 [info ] [MainThread]:   query_timeout: 0
[0m16:23:57.156736 [info ] [MainThread]: Registered adapter: fabric=1.7.4
[0m16:23:57.250199 [debug] [MainThread]: Acquiring new fabric connection 'debug'
[0m16:23:57.251103 [debug] [MainThread]: Using fabric connection "debug"
[0m16:23:57.251460 [debug] [MainThread]: On debug: select 1 as id
[0m16:23:57.251800 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:23:57.252243 [debug] [MainThread]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:24:10.940393 [debug] [MainThread]: fabric adapter: Connected to db: fabric-database
[0m16:24:11.033783 [debug] [MainThread]: SQL status: OK in 14.0 seconds
[0m16:24:11.037541 [debug] [MainThread]: On debug: Close
[0m16:24:11.038409 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:24:11.039127 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:24:11.093213 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 16.180563, "process_user_time": 2.768779, "process_kernel_time": 0.713412, "process_mem_max_rss": "113410048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:24:11.094139 [debug] [MainThread]: Command `dbt debug` succeeded at 16:24:11.093952 after 16.18 seconds
[0m16:24:11.094587 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:24:11.094995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c2ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105292070>]}
[0m16:24:11.095445 [debug] [MainThread]: Flushing usage events
[0m16:25:10.339155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b40b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667e7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106657130>]}


============================== 16:25:10.344696 | 666f95be-987b-487a-acf6-552930d02544 ==============================
[0m16:25:10.344696 [info ] [MainThread]: Running with dbt=1.7.7
[0m16:25:10.345270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:25:10.695576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '666f95be-987b-487a-acf6-552930d02544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104607160>]}
[0m16:25:10.775337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '666f95be-987b-487a-acf6-552930d02544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c65c70>]}
[0m16:25:10.775829 [info ] [MainThread]: Registered adapter: fabric=1.7.4
[0m16:25:10.795251 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m16:25:10.796014 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:25:10.796416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '666f95be-987b-487a-acf6-552930d02544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066357c0>]}
[0m16:25:12.313389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '666f95be-987b-487a-acf6-552930d02544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073fe0d0>]}
[0m16:25:12.335698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '666f95be-987b-487a-acf6-552930d02544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107206be0>]}
[0m16:25:12.336152 [info ] [MainThread]: Found 5 models, 3 seeds, 20 tests, 0 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m16:25:12.336500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '666f95be-987b-487a-acf6-552930d02544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f6f160>]}
[0m16:25:12.338027 [info ] [MainThread]: 
[0m16:25:12.338708 [debug] [MainThread]: Acquiring new fabric connection 'master'
[0m16:25:12.339699 [debug] [ThreadPool]: Acquiring new fabric connection 'list_fabric-database'
[0m16:25:12.350668 [debug] [ThreadPool]: Using fabric connection "list_fabric-database"
[0m16:25:12.351060 [debug] [ThreadPool]: On list_fabric-database: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "connection_name": "list_fabric-database"} */
select  name as [schema]
    from sys.schemas 
  
[0m16:25:12.351365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:12.351717 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:25:28.410851 [debug] [ThreadPool]: fabric adapter: Got a retryable error when attempting to open a fabric connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
('HYT00', '[HYT00] [Microsoft][ODBC Driver 18 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')
[0m16:25:29.413308 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:25:44.627771 [debug] [ThreadPool]: fabric adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "connection_name": "list_fabric-database"} */
select  name as [schema]
    from sys.schemas 
  
[0m16:25:44.629089 [debug] [ThreadPool]: fabric adapter: Rolling back transaction.
[0m16:25:44.629938 [debug] [ThreadPool]: On list_fabric-database: No close available on handle
[0m16:25:44.630757 [debug] [ThreadPool]: fabric adapter: Error running SQL: macro list_schemas
[0m16:25:44.631379 [debug] [ThreadPool]: fabric adapter: Rolling back transaction.
[0m16:25:44.634565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:44.635219 [debug] [MainThread]: Connection 'list_fabric-database' was properly closed.
[0m16:25:44.635911 [info ] [MainThread]: 
[0m16:25:44.636613 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 32.30 seconds (32.30s).
[0m16:25:44.637628 [error] [MainThread]: Encountered an error:
Database Error
  ('HYT00', '[HYT00] [Microsoft][ODBC Driver 18 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')
[0m16:25:44.641429 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 34.375626, "process_user_time": 3.375015, "process_kernel_time": 0.366525, "process_mem_max_rss": "123846656", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:25:44.642313 [debug] [MainThread]: Command `dbt seed` failed at 16:25:44.642122 after 34.38 seconds
[0m16:25:44.642808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b40b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107088f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738b130>]}
[0m16:25:44.643265 [debug] [MainThread]: Flushing usage events
[0m16:29:04.081491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d04b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b32790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b66b80>]}


============================== 16:29:04.086875 | e7248264-88db-4cf6-abcd-f9b46afb5e58 ==============================
[0m16:29:04.086875 [info ] [MainThread]: Running with dbt=1.7.7
[0m16:29:04.087418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:29:04.567993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7248264-88db-4cf6-abcd-f9b46afb5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b32790>]}
[0m16:29:04.648087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7248264-88db-4cf6-abcd-f9b46afb5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106414a90>]}
[0m16:29:04.648610 [info ] [MainThread]: Registered adapter: fabric=1.7.4
[0m16:29:04.706586 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m16:29:04.808206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:29:04.808617 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:29:04.815279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7248264-88db-4cf6-abcd-f9b46afb5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106737f40>]}
[0m16:29:04.859210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7248264-88db-4cf6-abcd-f9b46afb5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106457670>]}
[0m16:29:04.859703 [info ] [MainThread]: Found 5 models, 3 seeds, 20 tests, 0 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m16:29:04.860066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7248264-88db-4cf6-abcd-f9b46afb5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106457610>]}
[0m16:29:04.861844 [info ] [MainThread]: 
[0m16:29:04.862561 [debug] [MainThread]: Acquiring new fabric connection 'master'
[0m16:29:04.863658 [debug] [ThreadPool]: Acquiring new fabric connection 'list_fabric-database'
[0m16:29:04.875474 [debug] [ThreadPool]: Using fabric connection "list_fabric-database"
[0m16:29:04.876091 [debug] [ThreadPool]: On list_fabric-database: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "connection_name": "list_fabric-database"} */
select  name as [schema]
    from sys.schemas 
  
[0m16:29:04.876578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:04.877061 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:29:07.810863 [debug] [ThreadPool]: fabric adapter: Connected to db: fabric-database
[0m16:29:07.891176 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m16:29:07.894942 [debug] [ThreadPool]: On list_fabric-database: Close
[0m16:29:07.899045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_fabric-database, now list_fabric-database_dbo)
[0m16:29:07.907625 [debug] [ThreadPool]: Using fabric connection "list_fabric-database_dbo"
[0m16:29:07.908076 [debug] [ThreadPool]: On list_fabric-database_dbo: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "connection_name": "list_fabric-database_dbo"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
  
[0m16:29:07.908415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:07.908773 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:29:07.909540 [debug] [ThreadPool]: fabric adapter: Connected to db: fabric-database
[0m16:29:08.017561 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:08.021383 [debug] [ThreadPool]: On list_fabric-database_dbo: ROLLBACK
[0m16:29:08.022098 [debug] [ThreadPool]: On list_fabric-database_dbo: Close
[0m16:29:08.024030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7248264-88db-4cf6-abcd-f9b46afb5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106429ca0>]}
[0m16:29:08.025219 [debug] [MainThread]: On master: COMMIT
[0m16:29:08.026572 [info ] [MainThread]: Concurrency: 4 threads (target='fabric-dev')
[0m16:29:08.027208 [info ] [MainThread]: 
[0m16:29:08.059201 [debug] [Thread-1  ]: Began running node seed.jaffle_shop.raw_customers
[0m16:29:08.059788 [debug] [Thread-2  ]: Began running node seed.jaffle_shop.raw_orders
[0m16:29:08.060196 [debug] [Thread-3  ]: Began running node seed.jaffle_shop.raw_payments
[0m16:29:08.060698 [info ] [Thread-1  ]: 1 of 3 START seed file dbo.raw_customers ....................................... [RUN]
[0m16:29:08.061233 [info ] [Thread-2  ]: 2 of 3 START seed file dbo.raw_orders .......................................... [RUN]
[0m16:29:08.061741 [info ] [Thread-3  ]: 3 of 3 START seed file dbo.raw_payments ........................................ [RUN]
[0m16:29:08.062470 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_fabric-database_dbo, now seed.jaffle_shop.raw_customers)
[0m16:29:08.063127 [debug] [Thread-2  ]: Acquiring new fabric connection 'seed.jaffle_shop.raw_orders'
[0m16:29:08.063742 [debug] [Thread-3  ]: Acquiring new fabric connection 'seed.jaffle_shop.raw_payments'
[0m16:29:08.064095 [debug] [Thread-1  ]: Began compiling node seed.jaffle_shop.raw_customers
[0m16:29:08.064440 [debug] [Thread-2  ]: Began compiling node seed.jaffle_shop.raw_orders
[0m16:29:08.064793 [debug] [Thread-3  ]: Began compiling node seed.jaffle_shop.raw_payments
[0m16:29:08.065217 [debug] [Thread-1  ]: Timing info for seed.jaffle_shop.raw_customers (compile): 16:29:08.065014 => 16:29:08.065016
[0m16:29:08.065622 [debug] [Thread-2  ]: Timing info for seed.jaffle_shop.raw_orders (compile): 16:29:08.065445 => 16:29:08.065446
[0m16:29:08.066012 [debug] [Thread-3  ]: Timing info for seed.jaffle_shop.raw_payments (compile): 16:29:08.065832 => 16:29:08.065834
[0m16:29:08.066347 [debug] [Thread-1  ]: Began executing node seed.jaffle_shop.raw_customers
[0m16:29:08.066676 [debug] [Thread-2  ]: Began executing node seed.jaffle_shop.raw_orders
[0m16:29:08.067002 [debug] [Thread-3  ]: Began executing node seed.jaffle_shop.raw_payments
[0m16:29:08.148684 [debug] [Thread-1  ]: Using fabric connection "seed.jaffle_shop.raw_customers"
[0m16:29:08.150282 [debug] [Thread-2  ]: Using fabric connection "seed.jaffle_shop.raw_orders"
[0m16:29:08.153330 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "seed.jaffle_shop.raw_customers"} */

    create table "fabric-database"."dbo"."raw_customers" ("id" int,"first_name" varchar(16),"last_name" varchar(16))
  
[0m16:29:08.155086 [debug] [Thread-3  ]: Using fabric connection "seed.jaffle_shop.raw_payments"
[0m16:29:08.155497 [debug] [Thread-2  ]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "seed.jaffle_shop.raw_orders"} */

    create table "fabric-database"."dbo"."raw_orders" ("id" int,"user_id" int,"order_date" date,"status" varchar(16))
  
[0m16:29:08.155867 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:29:08.156220 [debug] [Thread-3  ]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "seed.jaffle_shop.raw_payments"} */

    create table "fabric-database"."dbo"."raw_payments" ("id" int,"order_id" int,"payment_method" varchar(16),"amount" int)
  
[0m16:29:08.156561 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:29:08.157035 [debug] [Thread-1  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:29:08.157443 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:29:08.157964 [debug] [Thread-2  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:29:08.158787 [debug] [Thread-1  ]: fabric adapter: Connected to db: fabric-database
[0m16:29:08.159150 [debug] [Thread-3  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:29:09.052763 [debug] [Thread-2  ]: fabric adapter: Connected to db: fabric-database
[0m16:29:09.116908 [debug] [Thread-3  ]: fabric adapter: Connected to db: fabric-database
[0m16:29:10.320306 [debug] [Thread-1  ]: SQL status: OK in 2.0 seconds
[0m16:29:10.346036 [debug] [Thread-1  ]: Inserting batches of 400 records
[0m16:29:10.346607 [debug] [Thread-3  ]: SQL status: OK in 2.0 seconds
[0m16:29:10.359563 [debug] [Thread-2  ]: SQL status: OK in 2.0 seconds
[0m16:29:10.367588 [debug] [Thread-3  ]: Inserting batches of 400 records
[0m16:29:10.393864 [debug] [Thread-2  ]: Inserting batches of 400 records
[0m16:29:10.490059 [debug] [Thread-1  ]: Using fabric connection "seed.jaffle_shop.raw_customers"
[0m16:29:10.509266 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: 
          insert into "fabric-database"."dbo"."raw_customers" ("id", "first_name", "last_name") values
          (?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?),(?,?,?...
[0m16:29:10.633020 [debug] [Thread-2  ]: Using fabric connection "seed.jaffle_shop.raw_orders"
[0m16:29:10.639101 [debug] [Thread-2  ]: On seed.jaffle_shop.raw_orders: 
          insert into "fabric-database"."dbo"."raw_orders" ("id", "user_id", "order_date", "status") values
          (?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,...
[0m16:29:10.655540 [debug] [Thread-3  ]: Using fabric connection "seed.jaffle_shop.raw_payments"
[0m16:29:10.655988 [debug] [Thread-3  ]: On seed.jaffle_shop.raw_payments: 
          insert into "fabric-database"."dbo"."raw_payments" ("id", "order_id", "payment_method", "amount") values
          (?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?,?),(?,?,?...
[0m16:29:16.722509 [debug] [Thread-3  ]: SQL status: OK in 6.0 seconds
[0m16:29:16.801677 [debug] [Thread-3  ]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m16:29:16.827452 [debug] [Thread-3  ]: On seed.jaffle_shop.raw_payments: COMMIT
[0m16:29:16.828005 [debug] [Thread-2  ]: SQL status: OK in 6.0 seconds
[0m16:29:16.828417 [debug] [Thread-1  ]: SQL status: OK in 6.0 seconds
[0m16:29:16.829287 [debug] [Thread-3  ]: Timing info for seed.jaffle_shop.raw_payments (execute): 16:29:08.130606 => 16:29:16.829074
[0m16:29:16.829843 [debug] [Thread-3  ]: On seed.jaffle_shop.raw_payments: Close
[0m16:29:16.830638 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7248264-88db-4cf6-abcd-f9b46afb5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106798970>]}
[0m16:29:16.831187 [info ] [Thread-3  ]: 3 of 3 OK loaded seed file dbo.raw_payments .................................... [[32mINSERT 113[0m in 8.77s]
[0m16:29:16.831780 [debug] [Thread-3  ]: Finished running node seed.jaffle_shop.raw_payments
[0m16:29:16.895539 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m16:29:16.896478 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m16:29:16.899458 [debug] [Thread-2  ]: On seed.jaffle_shop.raw_orders: COMMIT
[0m16:29:16.901690 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: COMMIT
[0m16:29:16.902500 [debug] [Thread-2  ]: Timing info for seed.jaffle_shop.raw_orders (execute): 16:29:08.111129 => 16:29:16.902300
[0m16:29:16.903272 [debug] [Thread-1  ]: Timing info for seed.jaffle_shop.raw_customers (execute): 16:29:08.067209 => 16:29:16.903084
[0m16:29:16.903633 [debug] [Thread-2  ]: On seed.jaffle_shop.raw_orders: Close
[0m16:29:16.903983 [debug] [Thread-1  ]: On seed.jaffle_shop.raw_customers: Close
[0m16:29:16.904629 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7248264-88db-4cf6-abcd-f9b46afb5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a2580>]}
[0m16:29:16.905242 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7248264-88db-4cf6-abcd-f9b46afb5e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106429ca0>]}
[0m16:29:16.905780 [info ] [Thread-2  ]: 2 of 3 OK loaded seed file dbo.raw_orders ...................................... [[32mINSERT 99[0m in 8.84s]
[0m16:29:16.906718 [debug] [Thread-2  ]: Finished running node seed.jaffle_shop.raw_orders
[0m16:29:16.906174 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file dbo.raw_customers ................................... [[32mINSERT 100[0m in 8.84s]
[0m16:29:16.907485 [debug] [Thread-1  ]: Finished running node seed.jaffle_shop.raw_customers
[0m16:29:16.908638 [debug] [MainThread]: On master: COMMIT
[0m16:29:16.909219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:16.909504 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m16:29:16.909777 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m16:29:16.910046 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m16:29:16.910348 [info ] [MainThread]: 
[0m16:29:16.910667 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 12.05 seconds (12.05s).
[0m16:29:16.911449 [debug] [MainThread]: Command end result
[0m16:29:16.929372 [info ] [MainThread]: 
[0m16:29:16.929834 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:29:16.930163 [info ] [MainThread]: 
[0m16:29:16.930508 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:29:16.956927 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 12.960307, "process_user_time": 2.884887, "process_kernel_time": 0.451315, "process_mem_max_rss": "126926848", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:29:16.957563 [debug] [MainThread]: Command `dbt seed` succeeded at 16:29:16.957424 after 12.96 seconds
[0m16:29:16.957966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d04b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10632d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106414a90>]}
[0m16:29:16.958361 [debug] [MainThread]: Flushing usage events
[0m16:31:08.326197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104974b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064b2b80>]}


============================== 16:31:08.331833 | fc8dab27-28f5-45a6-85bc-e27650d896f3 ==============================
[0m16:31:08.331833 [info ] [MainThread]: Running with dbt=1.7.7
[0m16:31:08.332365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:31:08.815313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc8dab27-28f5-45a6-85bc-e27650d896f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647f250>]}
[0m16:31:08.894982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc8dab27-28f5-45a6-85bc-e27650d896f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c54310>]}
[0m16:31:08.895514 [info ] [MainThread]: Registered adapter: fabric=1.7.4
[0m16:31:08.912345 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m16:31:09.002762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:31:09.003179 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:31:09.010034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc8dab27-28f5-45a6-85bc-e27650d896f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e77f40>]}
[0m16:31:09.051042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc8dab27-28f5-45a6-85bc-e27650d896f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c98670>]}
[0m16:31:09.051503 [info ] [MainThread]: Found 5 models, 3 seeds, 20 tests, 0 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m16:31:09.051873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc8dab27-28f5-45a6-85bc-e27650d896f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c98610>]}
[0m16:31:09.053662 [info ] [MainThread]: 
[0m16:31:09.054379 [debug] [MainThread]: Acquiring new fabric connection 'master'
[0m16:31:09.055522 [debug] [ThreadPool]: Acquiring new fabric connection 'list_fabric-database'
[0m16:31:09.067073 [debug] [ThreadPool]: Using fabric connection "list_fabric-database"
[0m16:31:09.067459 [debug] [ThreadPool]: On list_fabric-database: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "connection_name": "list_fabric-database"} */
select  name as [schema]
    from sys.schemas 
  
[0m16:31:09.067781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:09.068143 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:12.224600 [debug] [ThreadPool]: fabric adapter: Connected to db: fabric-database
[0m16:31:12.293509 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m16:31:12.295463 [debug] [ThreadPool]: On list_fabric-database: Close
[0m16:31:12.297543 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_fabric-database, now list_fabric-database_dbo)
[0m16:31:12.303815 [debug] [ThreadPool]: Using fabric connection "list_fabric-database_dbo"
[0m16:31:12.304193 [debug] [ThreadPool]: On list_fabric-database_dbo: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "connection_name": "list_fabric-database_dbo"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
  
[0m16:31:12.304535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:12.304892 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:12.305675 [debug] [ThreadPool]: fabric adapter: Connected to db: fabric-database
[0m16:31:12.390227 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:31:12.392122 [debug] [ThreadPool]: On list_fabric-database_dbo: ROLLBACK
[0m16:31:12.392661 [debug] [ThreadPool]: On list_fabric-database_dbo: Close
[0m16:31:12.394882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc8dab27-28f5-45a6-85bc-e27650d896f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c98850>]}
[0m16:31:12.395644 [debug] [MainThread]: On master: COMMIT
[0m16:31:12.396742 [info ] [MainThread]: Concurrency: 4 threads (target='fabric-dev')
[0m16:31:12.397319 [info ] [MainThread]: 
[0m16:31:12.406625 [debug] [Thread-1  ]: Began running node model.jaffle_shop.stg_customers
[0m16:31:12.407193 [debug] [Thread-2  ]: Began running node model.jaffle_shop.stg_orders
[0m16:31:12.408527 [debug] [Thread-3  ]: Began running node model.jaffle_shop.stg_payments
[0m16:31:12.408093 [info ] [Thread-1  ]: 1 of 5 START sql view model dbo.stg_customers .................................. [RUN]
[0m16:31:12.409232 [info ] [Thread-2  ]: 2 of 5 START sql view model dbo.stg_orders ..................................... [RUN]
[0m16:31:12.409837 [info ] [Thread-3  ]: 3 of 5 START sql view model dbo.stg_payments ................................... [RUN]
[0m16:31:12.410752 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_fabric-database_dbo, now model.jaffle_shop.stg_customers)
[0m16:31:12.411644 [debug] [Thread-2  ]: Acquiring new fabric connection 'model.jaffle_shop.stg_orders'
[0m16:31:12.412385 [debug] [Thread-3  ]: Acquiring new fabric connection 'model.jaffle_shop.stg_payments'
[0m16:31:12.412798 [debug] [Thread-1  ]: Began compiling node model.jaffle_shop.stg_customers
[0m16:31:12.413201 [debug] [Thread-2  ]: Began compiling node model.jaffle_shop.stg_orders
[0m16:31:12.413593 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.stg_payments
[0m16:31:12.422824 [debug] [Thread-1  ]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m16:31:12.460005 [debug] [Thread-2  ]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m16:31:12.462817 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m16:31:12.466322 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.stg_payments (compile): 16:31:12.460327 => 16:31:12.466022
[0m16:31:12.466899 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.stg_customers (compile): 16:31:12.413972 => 16:31:12.466609
[0m16:31:12.467330 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.stg_payments
[0m16:31:12.467882 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.stg_orders (compile): 16:31:12.423070 => 16:31:12.467614
[0m16:31:12.468295 [debug] [Thread-1  ]: Began executing node model.jaffle_shop.stg_customers
[0m16:31:12.486650 [debug] [Thread-2  ]: Began executing node model.jaffle_shop.stg_orders
[0m16:31:12.497646 [debug] [Thread-3  ]: Using fabric connection "model.jaffle_shop.stg_payments"
[0m16:31:12.502586 [debug] [Thread-1  ]: Using fabric connection "model.jaffle_shop.stg_customers"
[0m16:31:12.508141 [debug] [Thread-2  ]: Using fabric connection "model.jaffle_shop.stg_orders"
[0m16:31:12.508546 [debug] [Thread-3  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_payments"} */

      USE [fabric-database];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'fabric-database'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'stg_payments__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:31:12.508965 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_customers"} */

      USE [fabric-database];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'fabric-database'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'stg_customers__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:31:12.509367 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_orders"} */

      USE [fabric-database];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'fabric-database'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'stg_orders__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:31:12.509746 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:31:12.510082 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:31:12.510413 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:31:12.510784 [debug] [Thread-3  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:12.511156 [debug] [Thread-1  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:12.511520 [debug] [Thread-2  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:12.512328 [debug] [Thread-3  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:12.650347 [debug] [Thread-3  ]: SQL status: OK in 0.0 seconds
[0m16:31:12.651826 [debug] [Thread-3  ]: Using fabric connection "model.jaffle_shop.stg_payments"
[0m16:31:12.652261 [debug] [Thread-3  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_payments"} */

      
      
    
    USE [fabric-database];
    EXEC('DROP view IF EXISTS "dbo"."stg_payments__dbt_backup";');

[0m16:31:12.725286 [debug] [Thread-3  ]: SQL status: OK in 0.0 seconds
[0m16:31:12.729536 [debug] [Thread-3  ]: Using fabric connection "model.jaffle_shop.stg_payments"
[0m16:31:12.730002 [debug] [Thread-3  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_payments"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
    and table_name like 'stg_payments'
  
[0m16:31:12.808566 [debug] [Thread-3  ]: SQL status: OK in 0.0 seconds
[0m16:31:12.826004 [debug] [Thread-3  ]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m16:31:12.828423 [debug] [Thread-3  ]: Using fabric connection "model.jaffle_shop.stg_payments"
[0m16:31:12.829123 [debug] [Thread-3  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_payments"} */
USE [fabric-database];
    
    

    EXEC('create view "dbo"."stg_payments" as with source as (
    select * from "fabric-database"."dbo"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed;');



[0m16:31:12.899746 [debug] [Thread-3  ]: SQL status: OK in 0.0 seconds
[0m16:31:12.927790 [debug] [Thread-3  ]: On model.jaffle_shop.stg_payments: COMMIT
[0m16:31:12.931313 [debug] [Thread-3  ]: Using fabric connection "model.jaffle_shop.stg_payments"
[0m16:31:12.931775 [debug] [Thread-3  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_payments"} */

      USE [fabric-database];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'fabric-database'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'stg_payments__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:31:13.006403 [debug] [Thread-3  ]: SQL status: OK in 0.0 seconds
[0m16:31:13.008087 [debug] [Thread-3  ]: Using fabric connection "model.jaffle_shop.stg_payments"
[0m16:31:13.008590 [debug] [Thread-3  ]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_payments"} */

      
      
    
    USE [fabric-database];
    EXEC('DROP view IF EXISTS "dbo"."stg_payments__dbt_backup";');

[0m16:31:13.083908 [debug] [Thread-3  ]: SQL status: OK in 0.0 seconds
[0m16:31:13.085995 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.stg_payments (execute): 16:31:12.468542 => 16:31:13.085708
[0m16:31:13.086457 [debug] [Thread-3  ]: On model.jaffle_shop.stg_payments: ROLLBACK
[0m16:31:13.086860 [debug] [Thread-3  ]: On model.jaffle_shop.stg_payments: Close
[0m16:31:13.087668 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc8dab27-28f5-45a6-85bc-e27650d896f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fbe6d0>]}
[0m16:31:13.088372 [info ] [Thread-3  ]: 3 of 5 OK created sql view model dbo.stg_payments .............................. [[32mOK[0m in 0.68s]
[0m16:31:13.089025 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.stg_payments
[0m16:31:13.262014 [debug] [Thread-1  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:13.373943 [debug] [Thread-1  ]: SQL status: OK in 1.0 seconds
[0m16:31:13.377218 [debug] [Thread-1  ]: Using fabric connection "model.jaffle_shop.stg_customers"
[0m16:31:13.377844 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_customers"} */

      
      
    
    USE [fabric-database];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m16:31:13.456056 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m16:31:13.459931 [debug] [Thread-2  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:13.462357 [debug] [Thread-1  ]: Using fabric connection "model.jaffle_shop.stg_customers"
[0m16:31:13.463085 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_customers"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
    and table_name like 'stg_customers'
  
[0m16:31:13.556566 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m16:31:13.564268 [debug] [Thread-1  ]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m16:31:13.565435 [debug] [Thread-2  ]: SQL status: OK in 1.0 seconds
[0m16:31:13.567994 [debug] [Thread-2  ]: Using fabric connection "model.jaffle_shop.stg_orders"
[0m16:31:13.568814 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_orders"} */

      
      
    
    USE [fabric-database];
    EXEC('DROP view IF EXISTS "dbo"."stg_orders__dbt_backup";');

[0m16:31:13.569529 [debug] [Thread-1  ]: Using fabric connection "model.jaffle_shop.stg_customers"
[0m16:31:13.570242 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_customers"} */
USE [fabric-database];
    
    

    EXEC('create view "dbo"."stg_customers" as with source as (
    select * from "fabric-database"."dbo"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed;');



[0m16:31:13.641658 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m16:31:13.647283 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: COMMIT
[0m16:31:13.654982 [debug] [Thread-1  ]: Using fabric connection "model.jaffle_shop.stg_customers"
[0m16:31:13.655916 [debug] [Thread-2  ]: SQL status: OK in 0.0 seconds
[0m16:31:13.656663 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_customers"} */

      USE [fabric-database];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'fabric-database'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'stg_customers__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:31:13.659179 [debug] [Thread-2  ]: Using fabric connection "model.jaffle_shop.stg_orders"
[0m16:31:13.659876 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
    and table_name like 'stg_orders'
  
[0m16:31:13.753570 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m16:31:13.755521 [debug] [Thread-2  ]: SQL status: OK in 0.0 seconds
[0m16:31:13.761392 [debug] [Thread-2  ]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m16:31:13.762291 [debug] [Thread-1  ]: Using fabric connection "model.jaffle_shop.stg_customers"
[0m16:31:13.763209 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_customers"} */

      
      
    
    USE [fabric-database];
    EXEC('DROP view IF EXISTS "dbo"."stg_customers__dbt_backup";');

[0m16:31:13.764908 [debug] [Thread-2  ]: Using fabric connection "model.jaffle_shop.stg_orders"
[0m16:31:13.765581 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_orders"} */
USE [fabric-database];
    
    

    EXEC('create view "dbo"."stg_orders" as with source as (
    select * from "fabric-database"."dbo"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed;');



[0m16:31:13.827821 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m16:31:13.833176 [debug] [Thread-1  ]: Timing info for model.jaffle_shop.stg_customers (execute): 16:31:12.497918 => 16:31:13.832693
[0m16:31:13.834023 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: ROLLBACK
[0m16:31:13.834717 [debug] [Thread-1  ]: On model.jaffle_shop.stg_customers: Close
[0m16:31:13.836453 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc8dab27-28f5-45a6-85bc-e27650d896f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f35610>]}
[0m16:31:13.837690 [info ] [Thread-1  ]: 1 of 5 OK created sql view model dbo.stg_customers ............................. [[32mOK[0m in 1.43s]
[0m16:31:13.838683 [debug] [Thread-1  ]: Finished running node model.jaffle_shop.stg_customers
[0m16:31:13.849450 [debug] [Thread-2  ]: SQL status: OK in 0.0 seconds
[0m16:31:13.852434 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: COMMIT
[0m16:31:13.857618 [debug] [Thread-2  ]: Using fabric connection "model.jaffle_shop.stg_orders"
[0m16:31:13.858160 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_orders"} */

      USE [fabric-database];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'fabric-database'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'stg_orders__dbt_backup'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:31:13.938423 [debug] [Thread-2  ]: SQL status: OK in 0.0 seconds
[0m16:31:13.940546 [debug] [Thread-2  ]: Using fabric connection "model.jaffle_shop.stg_orders"
[0m16:31:13.941183 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.stg_orders"} */

      
      
    
    USE [fabric-database];
    EXEC('DROP view IF EXISTS "dbo"."stg_orders__dbt_backup";');

[0m16:31:14.004126 [debug] [Thread-2  ]: SQL status: OK in 0.0 seconds
[0m16:31:14.009296 [debug] [Thread-2  ]: Timing info for model.jaffle_shop.stg_orders (execute): 16:31:12.502831 => 16:31:14.008762
[0m16:31:14.010136 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: ROLLBACK
[0m16:31:14.010840 [debug] [Thread-2  ]: On model.jaffle_shop.stg_orders: Close
[0m16:31:14.012477 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc8dab27-28f5-45a6-85bc-e27650d896f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e77850>]}
[0m16:31:14.013652 [info ] [Thread-2  ]: 2 of 5 OK created sql view model dbo.stg_orders ................................ [[32mOK[0m in 1.60s]
[0m16:31:14.014569 [debug] [Thread-2  ]: Finished running node model.jaffle_shop.stg_orders
[0m16:31:14.015937 [debug] [Thread-4  ]: Began running node model.jaffle_shop.customers
[0m16:31:14.016685 [debug] [Thread-3  ]: Began running node model.jaffle_shop.orders
[0m16:31:14.017461 [info ] [Thread-4  ]: 4 of 5 START sql table model dbo.customers ..................................... [RUN]
[0m16:31:14.018349 [info ] [Thread-3  ]: 5 of 5 START sql table model dbo.orders ........................................ [RUN]
[0m16:31:14.019677 [debug] [Thread-4  ]: Acquiring new fabric connection 'model.jaffle_shop.customers'
[0m16:31:14.020695 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.orders)
[0m16:31:14.021252 [debug] [Thread-4  ]: Began compiling node model.jaffle_shop.customers
[0m16:31:14.021719 [debug] [Thread-3  ]: Began compiling node model.jaffle_shop.orders
[0m16:31:14.026746 [debug] [Thread-4  ]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m16:31:14.032959 [debug] [Thread-3  ]: Writing injected SQL for node "model.jaffle_shop.orders"
[0m16:31:14.034271 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.orders (compile): 16:31:14.027118 => 16:31:14.034006
[0m16:31:14.034825 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.customers (compile): 16:31:14.022030 => 16:31:14.034535
[0m16:31:14.035301 [debug] [Thread-3  ]: Began executing node model.jaffle_shop.orders
[0m16:31:14.035790 [debug] [Thread-4  ]: Began executing node model.jaffle_shop.customers
[0m16:31:14.047366 [debug] [Thread-3  ]: Using fabric connection "model.jaffle_shop.orders"
[0m16:31:14.052100 [debug] [Thread-4  ]: Using fabric connection "model.jaffle_shop.customers"
[0m16:31:14.052503 [debug] [Thread-3  ]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

      
      
    USE [fabric-database];
    EXEC('DROP table IF EXISTS "dbo"."orders__dbt_backup";');

[0m16:31:14.052875 [debug] [Thread-4  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

      
      
    USE [fabric-database];
    EXEC('DROP table IF EXISTS "dbo"."customers__dbt_backup";');

[0m16:31:14.053262 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:31:14.053602 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:31:14.053973 [debug] [Thread-3  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:14.054356 [debug] [Thread-4  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:14.055178 [debug] [Thread-3  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:14.127662 [debug] [Thread-3  ]: SQL status: OK in 0.0 seconds
[0m16:31:14.129023 [debug] [Thread-3  ]: Using fabric connection "model.jaffle_shop.orders"
[0m16:31:14.129421 [debug] [Thread-3  ]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
    and table_name like 'orders'
  
[0m16:31:14.219289 [debug] [Thread-3  ]: SQL status: OK in 0.0 seconds
[0m16:31:14.235318 [debug] [Thread-3  ]: Using fabric connection "model.jaffle_shop.orders"
[0m16:31:14.235731 [debug] [Thread-3  ]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

      USE [fabric-database];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'fabric-database'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:31:14.328886 [debug] [Thread-3  ]: SQL status: OK in 0.0 seconds
[0m16:31:14.332226 [debug] [Thread-3  ]: Using fabric connection "model.jaffle_shop.orders"
[0m16:31:14.332625 [debug] [Thread-3  ]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

    
      
      
    
    USE [fabric-database];
    EXEC('DROP view IF EXISTS "dbo"."orders_temp_view";');

  
[0m16:31:14.399286 [debug] [Thread-3  ]: SQL status: OK in 0.0 seconds
[0m16:31:14.401166 [debug] [Thread-3  ]: Using fabric connection "model.jaffle_shop.orders"
[0m16:31:14.401616 [debug] [Thread-3  ]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

      USE [fabric-database];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'fabric-database'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'orders_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:31:14.470090 [debug] [Thread-3  ]: SQL status: OK in 0.0 seconds
[0m16:31:14.473157 [debug] [Thread-3  ]: Writing runtime sql for node "model.jaffle_shop.orders"
[0m16:31:14.475197 [debug] [Thread-3  ]: Using fabric connection "model.jaffle_shop.orders"
[0m16:31:14.475990 [debug] [Thread-3  ]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

  
    

   

    USE [fabric-database];
    
    

    EXEC('create view "dbo"."orders_temp_view" as 

with orders as (

    select * from "fabric-database"."dbo"."stg_orders"

),

payments as (

    select * from "fabric-database"."dbo"."stg_payments"

),

order_payments as (

    select
        order_id,

        sum(case when payment_method = ''credit_card'' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = ''coupon'' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = ''bank_transfer'' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = ''gift_card'' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by order_id

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders


    left join order_payments
        on orders.order_id = order_payments.order_id

)

select * from final;');



    
      EXEC('CREATE TABLE [fabric-database].[dbo].[orders] AS (SELECT * FROM [fabric-database].[dbo].[orders_temp_view]);');
    

    
      
      
    
    USE [fabric-database];
    EXEC('DROP view IF EXISTS "dbo"."orders_temp_view";');



  
[0m16:31:14.810539 [debug] [Thread-4  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:14.874453 [debug] [Thread-4  ]: SQL status: OK in 1.0 seconds
[0m16:31:14.880013 [debug] [Thread-4  ]: Using fabric connection "model.jaffle_shop.customers"
[0m16:31:14.880986 [debug] [Thread-4  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
    and table_name like 'customers'
  
[0m16:31:14.958415 [debug] [Thread-4  ]: SQL status: OK in 0.0 seconds
[0m16:31:14.965779 [debug] [Thread-4  ]: Using fabric connection "model.jaffle_shop.customers"
[0m16:31:14.966734 [debug] [Thread-4  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

      USE [fabric-database];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'fabric-database'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'customers_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:31:15.057293 [debug] [Thread-4  ]: SQL status: OK in 0.0 seconds
[0m16:31:15.062192 [debug] [Thread-4  ]: Using fabric connection "model.jaffle_shop.customers"
[0m16:31:15.063093 [debug] [Thread-4  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

    
      
      
    
    USE [fabric-database];
    EXEC('DROP view IF EXISTS "dbo"."customers_temp_view";');

  
[0m16:31:15.123036 [debug] [Thread-4  ]: SQL status: OK in 0.0 seconds
[0m16:31:15.129195 [debug] [Thread-4  ]: Using fabric connection "model.jaffle_shop.customers"
[0m16:31:15.129899 [debug] [Thread-4  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

      USE [fabric-database];
      select
          sch.name as schema_name,
          obj.name as view_name
      from sys.sql_expression_dependencies refs
      inner join sys.objects obj
      on refs.referencing_id = obj.object_id
      inner join sys.schemas sch
      on obj.schema_id = sch.schema_id
      where refs.referenced_database_name = 'fabric-database'
      and refs.referenced_schema_name = 'dbo'
      and refs.referenced_entity_name = 'customers_temp_view'
      and refs.referencing_class = 1
      and obj.type = 'V'
      
[0m16:31:15.197788 [debug] [Thread-4  ]: SQL status: OK in 0.0 seconds
[0m16:31:15.202516 [debug] [Thread-4  ]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m16:31:15.204971 [debug] [Thread-4  ]: Using fabric connection "model.jaffle_shop.customers"
[0m16:31:15.205984 [debug] [Thread-4  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

  
    

   

    USE [fabric-database];
    
    

    EXEC('create view "dbo"."customers_temp_view" as with customers as (

    select * from "fabric-database"."dbo"."stg_customers"

),

orders as (

    select * from "fabric-database"."dbo"."stg_orders"

),

payments as (

    select * from "fabric-database"."dbo"."stg_payments"

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final;');



    
      EXEC('CREATE TABLE [fabric-database].[dbo].[customers] AS (SELECT * FROM [fabric-database].[dbo].[customers_temp_view]);');
    

    
      
      
    
    USE [fabric-database];
    EXEC('DROP view IF EXISTS "dbo"."customers_temp_view";');



  
[0m16:31:16.671930 [debug] [Thread-3  ]: SQL status: OK in 2.0 seconds
[0m16:31:16.673748 [debug] [Thread-3  ]: On model.jaffle_shop.orders: COMMIT
[0m16:31:16.677562 [debug] [Thread-3  ]: Using fabric connection "model.jaffle_shop.orders"
[0m16:31:16.678001 [debug] [Thread-3  ]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

      USE [fabric-database];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbo' and tab2.name = 'orders__dbt_backup'
  
[0m16:31:16.887590 [debug] [Thread-3  ]: SQL status: OK in 0.0 seconds
[0m16:31:16.891759 [debug] [Thread-3  ]: Using fabric connection "model.jaffle_shop.orders"
[0m16:31:16.892188 [debug] [Thread-3  ]: On model.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.orders"} */

      
      
    USE [fabric-database];
    EXEC('DROP table IF EXISTS "dbo"."orders__dbt_backup";');

[0m16:31:16.957434 [debug] [Thread-3  ]: SQL status: OK in 0.0 seconds
[0m16:31:16.965517 [debug] [Thread-3  ]: Timing info for model.jaffle_shop.orders (execute): 16:31:14.036079 => 16:31:16.965278
[0m16:31:16.965960 [debug] [Thread-3  ]: On model.jaffle_shop.orders: ROLLBACK
[0m16:31:16.966314 [debug] [Thread-3  ]: On model.jaffle_shop.orders: Close
[0m16:31:16.967050 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc8dab27-28f5-45a6-85bc-e27650d896f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107043700>]}
[0m16:31:16.967646 [info ] [Thread-3  ]: 5 of 5 OK created sql table model dbo.orders ................................... [[32mOK[0m in 2.95s]
[0m16:31:16.968329 [debug] [Thread-3  ]: Finished running node model.jaffle_shop.orders
[0m16:31:17.738898 [debug] [Thread-4  ]: SQL status: OK in 3.0 seconds
[0m16:31:17.744439 [debug] [Thread-4  ]: On model.jaffle_shop.customers: COMMIT
[0m16:31:17.745895 [debug] [Thread-4  ]: Using fabric connection "model.jaffle_shop.customers"
[0m16:31:17.746709 [debug] [Thread-4  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

      USE [fabric-database];
      SELECT  obj.name AS FK_NAME,
      sch.name AS [schema_name],
      tab1.name AS [table],
      col1.name AS [column],
      tab2.name AS [referenced_table],
      col2.name AS [referenced_column]
      FROM sys.foreign_key_columns fkc
      INNER JOIN sys.objects obj
          ON obj.object_id = fkc.constraint_object_id
      INNER JOIN sys.tables tab1
          ON tab1.object_id = fkc.parent_object_id
      INNER JOIN sys.schemas sch
          ON tab1.schema_id = sch.schema_id
      INNER JOIN sys.columns col1
          ON col1.column_id = parent_column_id AND col1.object_id = tab1.object_id
      INNER JOIN sys.tables tab2
          ON tab2.object_id = fkc.referenced_object_id
      INNER JOIN sys.columns col2
          ON col2.column_id = referenced_column_id AND col2.object_id = tab2.object_id
      WHERE sch.name = 'dbo' and tab2.name = 'customers__dbt_backup'
  
[0m16:31:17.930521 [debug] [Thread-4  ]: SQL status: OK in 0.0 seconds
[0m16:31:17.941322 [debug] [Thread-4  ]: Using fabric connection "model.jaffle_shop.customers"
[0m16:31:17.942024 [debug] [Thread-4  ]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "model.jaffle_shop.customers"} */

      
      
    USE [fabric-database];
    EXEC('DROP table IF EXISTS "dbo"."customers__dbt_backup";');

[0m16:31:18.006609 [debug] [Thread-4  ]: SQL status: OK in 0.0 seconds
[0m16:31:18.011809 [debug] [Thread-4  ]: Timing info for model.jaffle_shop.customers (execute): 16:31:14.047593 => 16:31:18.011360
[0m16:31:18.012651 [debug] [Thread-4  ]: On model.jaffle_shop.customers: ROLLBACK
[0m16:31:18.013333 [debug] [Thread-4  ]: On model.jaffle_shop.customers: Close
[0m16:31:18.014987 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc8dab27-28f5-45a6-85bc-e27650d896f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702bbb0>]}
[0m16:31:18.016273 [info ] [Thread-4  ]: 4 of 5 OK created sql table model dbo.customers ................................ [[32mOK[0m in 4.00s]
[0m16:31:18.017244 [debug] [Thread-4  ]: Finished running node model.jaffle_shop.customers
[0m16:31:18.019664 [debug] [MainThread]: On master: COMMIT
[0m16:31:18.020725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:18.021165 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m16:31:18.021481 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m16:31:18.021769 [debug] [MainThread]: Connection 'model.jaffle_shop.orders' was properly closed.
[0m16:31:18.022043 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m16:31:18.022420 [info ] [MainThread]: 
[0m16:31:18.022786 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 8.97 seconds (8.97s).
[0m16:31:18.023900 [debug] [MainThread]: Command end result
[0m16:31:18.064680 [info ] [MainThread]: 
[0m16:31:18.065232 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:18.065675 [info ] [MainThread]: 
[0m16:31:18.066070 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:31:18.068583 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.802817, "process_user_time": 2.831858, "process_kernel_time": 0.466135, "process_mem_max_rss": "123879424", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:31:18.069114 [debug] [MainThread]: Command `dbt run` succeeded at 16:31:18.068989 after 9.80 seconds
[0m16:31:18.069480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104974b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c69610>]}
[0m16:31:18.069850 [debug] [MainThread]: Flushing usage events
[0m16:31:36.664488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b20910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10482f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10485aac0>]}


============================== 16:31:36.670257 | e43d45c7-fbc7-49ef-be17-ba0177924780 ==============================
[0m16:31:36.670257 [info ] [MainThread]: Running with dbt=1.7.7
[0m16:31:36.670807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:31:36.992309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e43d45c7-fbc7-49ef-be17-ba0177924780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10482f190>]}
[0m16:31:37.074354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e43d45c7-fbc7-49ef-be17-ba0177924780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105021f10>]}
[0m16:31:37.074920 [info ] [MainThread]: Registered adapter: fabric=1.7.4
[0m16:31:37.090682 [debug] [MainThread]: checksum: 54188551c516f4dd1c42b8d9c289f2bf49f18ae42632e2ba36a64ad29fd60da4, vars: {}, profile: , target: , version: 1.7.7
[0m16:31:37.172120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:31:37.172538 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:31:37.179259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e43d45c7-fbc7-49ef-be17-ba0177924780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105436fa0>]}
[0m16:31:37.208714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e43d45c7-fbc7-49ef-be17-ba0177924780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10514b520>]}
[0m16:31:37.209197 [info ] [MainThread]: Found 5 models, 3 seeds, 20 tests, 0 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m16:31:37.209570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e43d45c7-fbc7-49ef-be17-ba0177924780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10514b550>]}
[0m16:31:37.211925 [info ] [MainThread]: 
[0m16:31:37.212661 [debug] [MainThread]: Acquiring new fabric connection 'master'
[0m16:31:37.213927 [debug] [ThreadPool]: Acquiring new fabric connection 'list_fabric-database_dbo'
[0m16:31:37.225591 [debug] [ThreadPool]: Using fabric connection "list_fabric-database_dbo"
[0m16:31:37.226013 [debug] [ThreadPool]: On list_fabric-database_dbo: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "connection_name": "list_fabric-database_dbo"} */
select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from INFORMATION_SCHEMA.TABLES 
    where table_schema like 'dbo'
  
[0m16:31:37.226360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:37.226719 [debug] [ThreadPool]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:39.164223 [debug] [ThreadPool]: fabric adapter: Connected to db: fabric-database
[0m16:31:39.270307 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m16:31:39.274740 [debug] [ThreadPool]: On list_fabric-database_dbo: ROLLBACK
[0m16:31:39.275507 [debug] [ThreadPool]: On list_fabric-database_dbo: Close
[0m16:31:39.280234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e43d45c7-fbc7-49ef-be17-ba0177924780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105436550>]}
[0m16:31:39.281131 [debug] [MainThread]: On master: COMMIT
[0m16:31:39.282204 [info ] [MainThread]: Concurrency: 4 threads (target='fabric-dev')
[0m16:31:39.282753 [info ] [MainThread]: 
[0m16:31:39.286398 [debug] [Thread-1  ]: Began running node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m16:31:39.286959 [debug] [Thread-2  ]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m16:31:39.287369 [debug] [Thread-3  ]: Began running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m16:31:39.288197 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:31:39.287815 [info ] [Thread-1  ]: 1 of 20 START test accepted_values_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m16:31:39.288770 [info ] [Thread-2  ]: 2 of 20 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m16:31:39.289276 [info ] [Thread-3  ]: 3 of 20 START test accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card  [RUN]
[0m16:31:39.289740 [info ] [Thread-4  ]: 4 of 20 START test not_null_customers_customer_id .............................. [RUN]
[0m16:31:39.290553 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_fabric-database_dbo, now test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3)
[0m16:31:39.291315 [debug] [Thread-2  ]: Acquiring new fabric connection 'test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad'
[0m16:31:39.292047 [debug] [Thread-3  ]: Acquiring new fabric connection 'test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278'
[0m16:31:39.292711 [debug] [Thread-4  ]: Acquiring new fabric connection 'test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d'
[0m16:31:39.293101 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m16:31:39.293517 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m16:31:39.293999 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m16:31:39.294447 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:31:39.354145 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m16:31:39.355408 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m16:31:39.361737 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m16:31:39.370255 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m16:31:39.371642 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278 (compile): 16:31:39.355669 => 16:31:39.371367
[0m16:31:39.372148 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d (compile): 16:31:39.362009 => 16:31:39.371923
[0m16:31:39.372555 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m16:31:39.373002 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (compile): 16:31:39.307317 => 16:31:39.372791
[0m16:31:39.373376 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:31:39.373804 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3 (compile): 16:31:39.294692 => 16:31:39.373597
[0m16:31:39.391128 [debug] [Thread-3  ]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m16:31:39.391574 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m16:31:39.394174 [debug] [Thread-4  ]: Writing runtime sql for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m16:31:39.394586 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m16:31:39.397354 [debug] [Thread-2  ]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m16:31:39.400791 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m16:31:39.401454 [debug] [Thread-3  ]: Using fabric connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
[0m16:31:39.401882 [debug] [Thread-3  ]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"} */

    

    

    EXEC('create view 
      dbo.testview_18020
     as 
    
    

with all_values as (

    select
        payment_method as value_field,
        count(*) as n_records

    from "fabric-database"."dbo"."stg_payments"
    group by payment_method

)

select *
from all_values
where value_field not in (
    ''credit_card'',''coupon'',''bank_transfer'',''gift_card''
)


;')
    select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      select * from 
      dbo.testview_18020
    
    ) dbt_internal_test;

    EXEC('drop view 
      dbo.testview_18020
    ;')

  
[0m16:31:39.402406 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:31:39.402869 [debug] [Thread-3  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:39.403289 [debug] [Thread-4  ]: Using fabric connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m16:31:39.404154 [debug] [Thread-1  ]: Using fabric connection "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
[0m16:31:39.404587 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select customer_id
from "fabric-database"."dbo"."customers"
where customer_id is null



    ) dbt_internal_test
[0m16:31:39.404985 [debug] [Thread-2  ]: Using fabric connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m16:31:39.405457 [debug] [Thread-3  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:39.405869 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"} */

    

    

    EXEC('create view 
      dbo.testview_5813
     as 
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "fabric-database"."dbo"."orders"
    group by status

)

select *
from all_values
where value_field not in (
    ''placed'',''shipped'',''completed'',''return_pending'',''returned''
)


;')
    select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      select * from 
      dbo.testview_5813
    
    ) dbt_internal_test;

    EXEC('drop view 
      dbo.testview_5813
    ;')

  
[0m16:31:39.406256 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:31:39.406683 [debug] [Thread-2  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */

    

    

    EXEC('create view 
      dbo.testview_16336
     as 
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "fabric-database"."dbo"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    ''placed'',''shipped'',''completed'',''return_pending'',''returned''
)


;')
    select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      select * from 
      dbo.testview_16336
    
    ) dbt_internal_test;

    EXEC('drop view 
      dbo.testview_16336
    ;')

  
[0m16:31:39.407154 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:31:39.407539 [debug] [Thread-4  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:39.407899 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:31:39.408301 [debug] [Thread-1  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:39.409224 [debug] [Thread-2  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:39.733602 [debug] [Thread-3  ]: SQL status: OK in 0.0 seconds
[0m16:31:39.739991 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278 (execute): 16:31:39.374034 => 16:31:39.739366
[0m16:31:39.740962 [debug] [Thread-3  ]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: ROLLBACK
[0m16:31:39.741747 [debug] [Thread-3  ]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: Close
[0m16:31:39.743766 [info ] [Thread-3  ]: 3 of 20 PASS accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card  [[32mPASS[0m in 0.45s]
[0m16:31:39.744818 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
[0m16:31:39.745584 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m16:31:39.746388 [info ] [Thread-3  ]: 5 of 20 START test not_null_orders_amount ...................................... [RUN]
[0m16:31:39.747377 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278, now test.jaffle_shop.not_null_orders_amount.106140f9fd)
[0m16:31:39.747813 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m16:31:39.752924 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m16:31:39.754215 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.not_null_orders_amount.106140f9fd (compile): 16:31:39.748064 => 16:31:39.753852
[0m16:31:39.754710 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m16:31:39.757659 [debug] [Thread-3  ]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m16:31:39.758582 [debug] [Thread-3  ]: Using fabric connection "test.jaffle_shop.not_null_orders_amount.106140f9fd"
[0m16:31:39.758973 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_orders_amount.106140f9fd: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.not_null_orders_amount.106140f9fd"} */
select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select amount
from "fabric-database"."dbo"."orders"
where amount is null



    ) dbt_internal_test
[0m16:31:39.759336 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:31:39.759706 [debug] [Thread-3  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:39.760497 [debug] [Thread-3  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:40.023865 [debug] [Thread-3  ]: SQL status: OK in 0.0 seconds
[0m16:31:40.025577 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.not_null_orders_amount.106140f9fd (execute): 16:31:39.755008 => 16:31:40.025325
[0m16:31:40.025984 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_orders_amount.106140f9fd: ROLLBACK
[0m16:31:40.026334 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_orders_amount.106140f9fd: Close
[0m16:31:40.027131 [info ] [Thread-3  ]: 5 of 20 PASS not_null_orders_amount ............................................ [[32mPASS[0m in 0.28s]
[0m16:31:40.027687 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_orders_amount.106140f9fd
[0m16:31:40.028102 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m16:31:40.028572 [info ] [Thread-3  ]: 6 of 20 START test not_null_orders_bank_transfer_amount ........................ [RUN]
[0m16:31:40.029296 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_orders_amount.106140f9fd, now test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49)
[0m16:31:40.029677 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m16:31:40.034623 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m16:31:40.035627 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49 (compile): 16:31:40.029903 => 16:31:40.035356
[0m16:31:40.036031 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m16:31:40.038858 [debug] [Thread-3  ]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m16:31:40.039758 [debug] [Thread-3  ]: Using fabric connection "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"
[0m16:31:40.040255 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49"} */
select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select bank_transfer_amount
from "fabric-database"."dbo"."orders"
where bank_transfer_amount is null



    ) dbt_internal_test
[0m16:31:40.040695 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:31:40.041092 [debug] [Thread-3  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:40.041897 [debug] [Thread-3  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:40.183016 [debug] [Thread-1  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:40.186132 [debug] [Thread-2  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:40.194737 [debug] [Thread-4  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:40.323402 [debug] [Thread-3  ]: SQL status: OK in 0.0 seconds
[0m16:31:40.328057 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49 (execute): 16:31:40.036261 => 16:31:40.327504
[0m16:31:40.328947 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49: ROLLBACK
[0m16:31:40.329649 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49: Close
[0m16:31:40.331622 [info ] [Thread-3  ]: 6 of 20 PASS not_null_orders_bank_transfer_amount .............................. [[32mPASS[0m in 0.30s]
[0m16:31:40.332962 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49
[0m16:31:40.333833 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m16:31:40.334628 [info ] [Thread-3  ]: 7 of 20 START test not_null_orders_coupon_amount ............................... [RUN]
[0m16:31:40.335763 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49, now test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625)
[0m16:31:40.336332 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m16:31:40.341671 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m16:31:40.342923 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625 (compile): 16:31:40.336746 => 16:31:40.342661
[0m16:31:40.343328 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m16:31:40.346403 [debug] [Thread-3  ]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m16:31:40.347233 [debug] [Thread-3  ]: Using fabric connection "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"
[0m16:31:40.347613 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625"} */
select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select coupon_amount
from "fabric-database"."dbo"."orders"
where coupon_amount is null



    ) dbt_internal_test
[0m16:31:40.347970 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:31:40.348333 [debug] [Thread-3  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:40.349127 [debug] [Thread-3  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:40.469585 [debug] [Thread-2  ]: SQL status: OK in 1.0 seconds
[0m16:31:40.471352 [debug] [Thread-1  ]: SQL status: OK in 1.0 seconds
[0m16:31:40.475397 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (execute): 16:31:39.394933 => 16:31:40.474874
[0m16:31:40.477761 [debug] [Thread-2  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: ROLLBACK
[0m16:31:40.479049 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3 (execute): 16:31:39.397732 => 16:31:40.478658
[0m16:31:40.479768 [debug] [Thread-2  ]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
[0m16:31:40.480443 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3: ROLLBACK
[0m16:31:40.482677 [debug] [Thread-1  ]: On test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3: Close
[0m16:31:40.482191 [info ] [Thread-2  ]: 2 of 20 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 1.19s]
[0m16:31:40.483648 [info ] [Thread-1  ]: 1 of 20 PASS accepted_values_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 1.19s]
[0m16:31:40.484289 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m16:31:40.484853 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
[0m16:31:40.485422 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m16:31:40.486172 [debug] [Thread-1  ]: Began running node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m16:31:40.486880 [info ] [Thread-2  ]: 8 of 20 START test not_null_orders_credit_card_amount .......................... [RUN]
[0m16:31:40.487553 [info ] [Thread-1  ]: 9 of 20 START test not_null_orders_customer_id ................................. [RUN]
[0m16:31:40.488701 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad, now test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59)
[0m16:31:40.489682 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3, now test.jaffle_shop.not_null_orders_customer_id.c5f02694af)
[0m16:31:40.490272 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m16:31:40.490743 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m16:31:40.498859 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m16:31:40.503808 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m16:31:40.504364 [debug] [Thread-4  ]: SQL status: OK in 1.0 seconds
[0m16:31:40.505806 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d (execute): 16:31:39.391828 => 16:31:40.505565
[0m16:31:40.506251 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
[0m16:31:40.506730 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.not_null_orders_customer_id.c5f02694af (compile): 16:31:40.499167 => 16:31:40.506514
[0m16:31:40.507109 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: Close
[0m16:31:40.507505 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59 (compile): 16:31:40.491048 => 16:31:40.507316
[0m16:31:40.507845 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m16:31:40.508587 [info ] [Thread-4  ]: 4 of 20 PASS not_null_customers_customer_id .................................... [[32mPASS[0m in 1.22s]
[0m16:31:40.509010 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m16:31:40.511607 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m16:31:40.512134 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:31:40.514720 [debug] [Thread-2  ]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m16:31:40.515273 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m16:31:40.515881 [info ] [Thread-4  ]: 10 of 20 START test not_null_orders_gift_card_amount ........................... [RUN]
[0m16:31:40.516374 [debug] [Thread-1  ]: Using fabric connection "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"
[0m16:31:40.517011 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d, now test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a)
[0m16:31:40.517437 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_customer_id.c5f02694af: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.not_null_orders_customer_id.c5f02694af"} */
select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select customer_id
from "fabric-database"."dbo"."orders"
where customer_id is null



    ) dbt_internal_test
[0m16:31:40.517830 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m16:31:40.518212 [debug] [Thread-2  ]: Using fabric connection "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"
[0m16:31:40.518530 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:31:40.522722 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m16:31:40.523124 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59"} */
select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select credit_card_amount
from "fabric-database"."dbo"."orders"
where credit_card_amount is null



    ) dbt_internal_test
[0m16:31:40.523559 [debug] [Thread-1  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:40.524020 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:31:40.524886 [debug] [Thread-2  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:40.525728 [debug] [Thread-2  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:40.526147 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a (compile): 16:31:40.518742 => 16:31:40.525940
[0m16:31:40.526476 [debug] [Thread-1  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:40.526860 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m16:31:40.529330 [debug] [Thread-4  ]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m16:31:40.530268 [debug] [Thread-4  ]: Using fabric connection "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"
[0m16:31:40.530640 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a"} */
select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select gift_card_amount
from "fabric-database"."dbo"."orders"
where gift_card_amount is null



    ) dbt_internal_test
[0m16:31:40.530988 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:31:40.531343 [debug] [Thread-4  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:40.532118 [debug] [Thread-4  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:40.593887 [debug] [Thread-3  ]: SQL status: OK in 0.0 seconds
[0m16:31:40.595405 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625 (execute): 16:31:40.343552 => 16:31:40.595166
[0m16:31:40.595797 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625: ROLLBACK
[0m16:31:40.596137 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625: Close
[0m16:31:40.596920 [info ] [Thread-3  ]: 7 of 20 PASS not_null_orders_coupon_amount ..................................... [[32mPASS[0m in 0.26s]
[0m16:31:40.597457 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625
[0m16:31:40.597868 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m16:31:40.598351 [info ] [Thread-3  ]: 11 of 20 START test not_null_orders_order_id ................................... [RUN]
[0m16:31:40.599068 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625, now test.jaffle_shop.not_null_orders_order_id.cf6c17daed)
[0m16:31:40.599445 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m16:31:40.603968 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m16:31:40.604903 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.not_null_orders_order_id.cf6c17daed (compile): 16:31:40.599666 => 16:31:40.604650
[0m16:31:40.605284 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m16:31:40.608902 [debug] [Thread-3  ]: Writing runtime sql for node "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m16:31:40.609691 [debug] [Thread-3  ]: Using fabric connection "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"
[0m16:31:40.610069 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_orders_order_id.cf6c17daed: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.not_null_orders_order_id.cf6c17daed"} */
select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select order_id
from "fabric-database"."dbo"."orders"
where order_id is null



    ) dbt_internal_test
[0m16:31:40.610422 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:31:40.610788 [debug] [Thread-3  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:40.611579 [debug] [Thread-3  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:40.636327 [debug] [Thread-2  ]: SQL status: OK in 0.0 seconds
[0m16:31:40.637878 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59 (execute): 16:31:40.512374 => 16:31:40.637641
[0m16:31:40.638273 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59: ROLLBACK
[0m16:31:40.638616 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59: Close
[0m16:31:40.639359 [info ] [Thread-2  ]: 8 of 20 PASS not_null_orders_credit_card_amount ................................ [[32mPASS[0m in 0.15s]
[0m16:31:40.639895 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59
[0m16:31:40.640288 [debug] [Thread-2  ]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:31:40.640732 [info ] [Thread-2  ]: 12 of 20 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m16:31:40.641412 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m16:31:40.641785 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:31:40.646311 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:31:40.647466 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 16:31:40.642002 => 16:31:40.647221
[0m16:31:40.647854 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:31:40.650508 [debug] [Thread-2  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:31:40.651321 [debug] [Thread-2  ]: Using fabric connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m16:31:40.651703 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select customer_id
from "fabric-database"."dbo"."stg_customers"
where customer_id is null



    ) dbt_internal_test
[0m16:31:40.652068 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:31:40.652464 [debug] [Thread-2  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:40.653310 [debug] [Thread-4  ]: SQL status: OK in 0.0 seconds
[0m16:31:40.653760 [debug] [Thread-2  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:40.655139 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a (execute): 16:31:40.527118 => 16:31:40.654927
[0m16:31:40.655495 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a: ROLLBACK
[0m16:31:40.655830 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a: Close
[0m16:31:40.656540 [info ] [Thread-4  ]: 10 of 20 PASS not_null_orders_gift_card_amount ................................. [[32mPASS[0m in 0.14s]
[0m16:31:40.657054 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a
[0m16:31:40.657439 [debug] [Thread-4  ]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m16:31:40.657828 [info ] [Thread-4  ]: 13 of 20 START test not_null_stg_orders_order_id ............................... [RUN]
[0m16:31:40.658429 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m16:31:40.658769 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m16:31:40.663092 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:31:40.663926 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (compile): 16:31:40.658974 => 16:31:40.663720
[0m16:31:40.664281 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m16:31:40.666853 [debug] [Thread-4  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:31:40.667641 [debug] [Thread-4  ]: Using fabric connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:31:40.668015 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select order_id
from "fabric-database"."dbo"."stg_orders"
where order_id is null



    ) dbt_internal_test
[0m16:31:40.668377 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:31:40.668741 [debug] [Thread-4  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:40.669556 [debug] [Thread-4  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:40.725478 [debug] [Thread-3  ]: SQL status: OK in 0.0 seconds
[0m16:31:40.727051 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.not_null_orders_order_id.cf6c17daed (execute): 16:31:40.605505 => 16:31:40.726811
[0m16:31:40.727443 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_orders_order_id.cf6c17daed: ROLLBACK
[0m16:31:40.727786 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_orders_order_id.cf6c17daed: Close
[0m16:31:40.728542 [info ] [Thread-3  ]: 11 of 20 PASS not_null_orders_order_id ......................................... [[32mPASS[0m in 0.13s]
[0m16:31:40.729078 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_orders_order_id.cf6c17daed
[0m16:31:40.729475 [debug] [Thread-3  ]: Began running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m16:31:40.729875 [info ] [Thread-3  ]: 14 of 20 START test not_null_stg_payments_payment_id ........................... [RUN]
[0m16:31:40.730606 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_orders_order_id.cf6c17daed, now test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075)
[0m16:31:40.731022 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m16:31:40.735573 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m16:31:40.736559 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075 (compile): 16:31:40.731252 => 16:31:40.736311
[0m16:31:40.736941 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m16:31:40.739458 [debug] [Thread-3  ]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m16:31:40.740393 [debug] [Thread-3  ]: Using fabric connection "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"
[0m16:31:40.740774 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075"} */
select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select payment_id
from "fabric-database"."dbo"."stg_payments"
where payment_id is null



    ) dbt_internal_test
[0m16:31:40.741234 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:31:40.741602 [debug] [Thread-3  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:40.742388 [debug] [Thread-3  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:40.766837 [debug] [Thread-2  ]: SQL status: OK in 0.0 seconds
[0m16:31:40.768413 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 16:31:40.648074 => 16:31:40.768162
[0m16:31:40.768813 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m16:31:40.769157 [debug] [Thread-2  ]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m16:31:40.769925 [info ] [Thread-2  ]: 12 of 20 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.13s]
[0m16:31:40.770457 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m16:31:40.770887 [debug] [Thread-2  ]: Began running node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m16:31:40.771338 [info ] [Thread-2  ]: 15 of 20 START test relationships_orders_customer_id__customer_id__ref_customers_  [RUN]
[0m16:31:40.772041 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2)
[0m16:31:40.772415 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m16:31:40.781474 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m16:31:40.782001 [debug] [Thread-4  ]: SQL status: OK in 0.0 seconds
[0m16:31:40.783439 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (execute): 16:31:40.664493 => 16:31:40.783217
[0m16:31:40.783915 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2 (compile): 16:31:40.772632 => 16:31:40.783673
[0m16:31:40.784336 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m16:31:40.784742 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m16:31:40.785143 [debug] [Thread-4  ]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m16:31:40.787790 [debug] [Thread-2  ]: Writing runtime sql for node "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m16:31:40.788550 [info ] [Thread-4  ]: 13 of 20 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.13s]
[0m16:31:40.789244 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m16:31:40.789628 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m16:31:40.790019 [debug] [Thread-4  ]: Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:31:40.790551 [info ] [Thread-4  ]: 16 of 20 START test unique_customers_customer_id ............................... [RUN]
[0m16:31:40.791669 [debug] [Thread-2  ]: Using fabric connection "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
[0m16:31:40.792317 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1)
[0m16:31:40.792936 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.not_null_orders_customer_id.c5f02694af (execute): 16:31:40.509254 => 16:31:40.792722
[0m16:31:40.793369 [debug] [Thread-2  ]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"} */

    

    

    EXEC('create view 
      dbo.testview_13559
     as 
    
    

with child as (
    select customer_id as from_field
    from "fabric-database"."dbo"."orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "fabric-database"."dbo"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


;')
    select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      select * from 
      dbo.testview_13559
    
    ) dbt_internal_test;

    EXEC('drop view 
      dbo.testview_13559
    ;')

  
[0m16:31:40.793791 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:31:40.794168 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_customer_id.c5f02694af: ROLLBACK
[0m16:31:40.794547 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:31:40.801412 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m16:31:40.801938 [debug] [Thread-1  ]: On test.jaffle_shop.not_null_orders_customer_id.c5f02694af: Close
[0m16:31:40.802410 [debug] [Thread-2  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:40.803315 [info ] [Thread-1  ]: 9 of 20 PASS not_null_orders_customer_id ....................................... [[32mPASS[0m in 0.31s]
[0m16:31:40.804230 [debug] [Thread-2  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:40.804753 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.not_null_orders_customer_id.c5f02694af
[0m16:31:40.805256 [debug] [Thread-1  ]: Began running node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m16:31:40.806038 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 16:31:40.794946 => 16:31:40.805837
[0m16:31:40.805680 [info ] [Thread-1  ]: 17 of 20 START test unique_orders_order_id ..................................... [RUN]
[0m16:31:40.806474 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:31:40.807073 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_orders_customer_id.c5f02694af, now test.jaffle_shop.unique_orders_order_id.fed79b3a6e)
[0m16:31:40.809745 [debug] [Thread-4  ]: Writing runtime sql for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m16:31:40.810111 [debug] [Thread-1  ]: Began compiling node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m16:31:40.814176 [debug] [Thread-1  ]: Writing injected SQL for node "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m16:31:40.814909 [debug] [Thread-4  ]: Using fabric connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m16:31:40.815334 [debug] [Thread-4  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "fabric-database"."dbo"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



    ) dbt_internal_test
[0m16:31:40.815733 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:31:40.816103 [debug] [Thread-4  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:40.816523 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.unique_orders_order_id.fed79b3a6e (compile): 16:31:40.810402 => 16:31:40.816314
[0m16:31:40.817374 [debug] [Thread-4  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:40.817751 [debug] [Thread-1  ]: Began executing node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m16:31:40.820689 [debug] [Thread-1  ]: Writing runtime sql for node "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m16:31:40.821484 [debug] [Thread-1  ]: Using fabric connection "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"
[0m16:31:40.821855 [debug] [Thread-1  ]: On test.jaffle_shop.unique_orders_order_id.fed79b3a6e: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.unique_orders_order_id.fed79b3a6e"} */
select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "fabric-database"."dbo"."orders"
where order_id is not null
group by order_id
having count(*) > 1



    ) dbt_internal_test
[0m16:31:40.822211 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:31:40.822562 [debug] [Thread-1  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:40.823337 [debug] [Thread-1  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:40.920382 [debug] [Thread-4  ]: SQL status: OK in 0.0 seconds
[0m16:31:40.921992 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 16:31:40.807324 => 16:31:40.921749
[0m16:31:40.922396 [debug] [Thread-4  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
[0m16:31:40.922744 [debug] [Thread-4  ]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: Close
[0m16:31:40.923547 [info ] [Thread-4  ]: 16 of 20 PASS unique_customers_customer_id ..................................... [[32mPASS[0m in 0.13s]
[0m16:31:40.924093 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:31:40.924495 [debug] [Thread-4  ]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m16:31:40.924949 [info ] [Thread-4  ]: 18 of 20 START test unique_stg_customers_customer_id ........................... [RUN]
[0m16:31:40.925642 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m16:31:40.926017 [debug] [Thread-4  ]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m16:31:40.930401 [debug] [Thread-4  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m16:31:40.931317 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (compile): 16:31:40.926237 => 16:31:40.931069
[0m16:31:40.931707 [debug] [Thread-4  ]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m16:31:40.934383 [debug] [Thread-4  ]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m16:31:40.934876 [debug] [Thread-2  ]: SQL status: OK in 0.0 seconds
[0m16:31:40.936468 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2 (execute): 16:31:40.785357 => 16:31:40.936186
[0m16:31:40.936892 [debug] [Thread-4  ]: Using fabric connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m16:31:40.937288 [debug] [Thread-2  ]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: ROLLBACK
[0m16:31:40.937721 [debug] [Thread-4  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "fabric-database"."dbo"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



    ) dbt_internal_test
[0m16:31:40.938173 [debug] [Thread-2  ]: On test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: Close
[0m16:31:40.938526 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:31:40.939313 [info ] [Thread-2  ]: 15 of 20 PASS relationships_orders_customer_id__customer_id__ref_customers_ .... [[32mPASS[0m in 0.17s]
[0m16:31:40.939756 [debug] [Thread-4  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:40.940298 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
[0m16:31:40.941158 [debug] [Thread-2  ]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m16:31:40.941581 [debug] [Thread-4  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:40.941943 [info ] [Thread-2  ]: 19 of 20 START test unique_stg_orders_order_id ................................. [RUN]
[0m16:31:40.942654 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m16:31:40.943025 [debug] [Thread-2  ]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m16:31:40.948705 [debug] [Thread-2  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m16:31:40.949698 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (compile): 16:31:40.943242 => 16:31:40.949478
[0m16:31:40.950070 [debug] [Thread-2  ]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m16:31:40.952590 [debug] [Thread-2  ]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m16:31:40.953413 [debug] [Thread-2  ]: Using fabric connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m16:31:40.953785 [debug] [Thread-2  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "fabric-database"."dbo"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



    ) dbt_internal_test
[0m16:31:40.954138 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:31:40.954497 [debug] [Thread-2  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:40.955281 [debug] [Thread-2  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:41.006687 [debug] [Thread-3  ]: SQL status: OK in 0.0 seconds
[0m16:31:41.008208 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075 (execute): 16:31:40.737161 => 16:31:41.007972
[0m16:31:41.008595 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m16:31:41.008931 [debug] [Thread-3  ]: On test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075: Close
[0m16:31:41.009701 [info ] [Thread-3  ]: 14 of 20 PASS not_null_stg_payments_payment_id ................................. [[32mPASS[0m in 0.28s]
[0m16:31:41.010223 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075
[0m16:31:41.010619 [debug] [Thread-3  ]: Began running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m16:31:41.011059 [info ] [Thread-3  ]: 20 of 20 START test unique_stg_payments_payment_id ............................. [RUN]
[0m16:31:41.011760 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075, now test.jaffle_shop.unique_stg_payments_payment_id.3744510712)
[0m16:31:41.012127 [debug] [Thread-3  ]: Began compiling node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m16:31:41.016615 [debug] [Thread-3  ]: Writing injected SQL for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m16:31:41.017539 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.unique_stg_payments_payment_id.3744510712 (compile): 16:31:41.012344 => 16:31:41.017331
[0m16:31:41.017886 [debug] [Thread-3  ]: Began executing node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m16:31:41.020438 [debug] [Thread-3  ]: Writing runtime sql for node "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m16:31:41.021353 [debug] [Thread-3  ]: Using fabric connection "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"
[0m16:31:41.021790 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.7.7", "profile_name": "jaffle_shop", "target_name": "fabric-dev", "node_id": "test.jaffle_shop.unique_stg_payments_payment_id.3744510712"} */
select
      
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "fabric-database"."dbo"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



    ) dbt_internal_test
[0m16:31:41.022268 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:31:41.022627 [debug] [Thread-3  ]: fabric adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=x6eps4xrq2xudenlfv6naeo3i4-nkbn5kalhahujjtdo4w6y2qbeu.msit-datawarehouse.fabric.microsoft.com;Database=fabric-database;encrypt=Yes;TrustServerCertificate=No;APP=dbt-fabric/1.7.4;ConnectRetryCount=1
[0m16:31:41.023417 [debug] [Thread-3  ]: fabric adapter: Connected to db: fabric-database
[0m16:31:41.073936 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m16:31:41.074410 [debug] [Thread-4  ]: SQL status: OK in 0.0 seconds
[0m16:31:41.074789 [debug] [Thread-2  ]: SQL status: OK in 0.0 seconds
[0m16:31:41.076273 [debug] [Thread-1  ]: Timing info for test.jaffle_shop.unique_orders_order_id.fed79b3a6e (execute): 16:31:40.818121 => 16:31:41.076015
[0m16:31:41.077582 [debug] [Thread-4  ]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (execute): 16:31:40.931938 => 16:31:41.077360
[0m16:31:41.078003 [debug] [Thread-1  ]: On test.jaffle_shop.unique_orders_order_id.fed79b3a6e: ROLLBACK
[0m16:31:41.079287 [debug] [Thread-2  ]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (execute): 16:31:40.950291 => 16:31:41.079068
[0m16:31:41.079639 [debug] [Thread-4  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m16:31:41.080013 [debug] [Thread-1  ]: On test.jaffle_shop.unique_orders_order_id.fed79b3a6e: Close
[0m16:31:41.080341 [debug] [Thread-2  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m16:31:41.080675 [debug] [Thread-4  ]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m16:31:41.081429 [info ] [Thread-1  ]: 17 of 20 PASS unique_orders_order_id ........................................... [[32mPASS[0m in 0.27s]
[0m16:31:41.081856 [debug] [Thread-2  ]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m16:31:41.082581 [info ] [Thread-4  ]: 18 of 20 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.16s]
[0m16:31:41.083138 [debug] [Thread-1  ]: Finished running node test.jaffle_shop.unique_orders_order_id.fed79b3a6e
[0m16:31:41.083848 [info ] [Thread-2  ]: 19 of 20 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.14s]
[0m16:31:41.084372 [debug] [Thread-4  ]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m16:31:41.084978 [debug] [Thread-2  ]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m16:31:41.124556 [debug] [Thread-3  ]: SQL status: OK in 0.0 seconds
[0m16:31:41.126148 [debug] [Thread-3  ]: Timing info for test.jaffle_shop.unique_stg_payments_payment_id.3744510712 (execute): 16:31:41.018094 => 16:31:41.125899
[0m16:31:41.126569 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m16:31:41.126914 [debug] [Thread-3  ]: On test.jaffle_shop.unique_stg_payments_payment_id.3744510712: Close
[0m16:31:41.127681 [info ] [Thread-3  ]: 20 of 20 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.12s]
[0m16:31:41.128216 [debug] [Thread-3  ]: Finished running node test.jaffle_shop.unique_stg_payments_payment_id.3744510712
[0m16:31:41.129463 [debug] [MainThread]: On master: COMMIT
[0m16:31:41.130052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:41.130344 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_orders_order_id.fed79b3a6e' was properly closed.
[0m16:31:41.130615 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m16:31:41.130880 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m16:31:41.131146 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m16:31:41.131519 [info ] [MainThread]: 
[0m16:31:41.131863 [info ] [MainThread]: Finished running 20 tests in 0 hours 0 minutes and 3.92 seconds (3.92s).
[0m16:31:41.134493 [debug] [MainThread]: Command end result
[0m16:31:41.156865 [info ] [MainThread]: 
[0m16:31:41.157273 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:41.157616 [info ] [MainThread]: 
[0m16:31:41.157944 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=0 SKIP=0 TOTAL=20
[0m16:31:41.160568 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.5728602, "process_user_time": 2.907541, "process_kernel_time": 0.349609, "process_mem_max_rss": "127025152", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:31:41.161123 [debug] [MainThread]: Command `dbt test` succeeded at 16:31:41.160994 after 4.57 seconds
[0m16:31:41.161498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b20910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b3b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105021f10>]}
[0m16:31:41.161873 [debug] [MainThread]: Flushing usage events
[0m23:05:46.296360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b77a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bdbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bdbd50>]}


============================== 23:05:46.300382 | a4d665f1-3667-4207-a688-52eb50fa012e ==============================
[0m23:05:46.300382 [info ] [MainThread]: Running with dbt=1.7.3
[0m23:05:46.300864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/dags/jaffle_shop/logs', 'profiles_dir': '/Users/ambikagarg/Documents/MS-Work/fabric-dbt/dags/jaffle_shop', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:05:46.301363 [info ] [MainThread]: dbt version: 1.7.3
[0m23:05:46.301632 [info ] [MainThread]: python version: 3.11.6
[0m23:05:46.301890 [info ] [MainThread]: python path: /Users/ambikagarg/.pyenv/versions/airflow_venv/bin/python
[0m23:05:46.302121 [info ] [MainThread]: os info: macOS-14.3.1-arm64-arm-64bit
[0m23:05:46.365529 [error] [MainThread]: Encountered an error:
dlopen(/Users/ambikagarg/.pyenv/versions/airflow_venv/lib/python3.11/site-packages/pyodbc.cpython-311-darwin.so, 0x0002): symbol not found in flat namespace '_SQLAllocHandle'
[0m23:05:46.558229 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/ambikagarg/.pyenv/versions/airflow_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ambikagarg/.pyenv/versions/airflow_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ambikagarg/.pyenv/versions/airflow_venv/lib/python3.11/site-packages/dbt/cli/main.py", line 444, in debug
    results = task.run()
              ^^^^^^^^^^
  File "/Users/ambikagarg/.pyenv/versions/airflow_venv/lib/python3.11/site-packages/dbt/task/debug.py", line 123, in run
    load_profile_status: SubtaskStatus = self._load_profile()
                                         ^^^^^^^^^^^^^^^^^^^^
  File "/Users/ambikagarg/.pyenv/versions/airflow_venv/lib/python3.11/site-packages/dbt/task/debug.py", line 212, in _load_profile
    profile: Profile = Profile.render(
                       ^^^^^^^^^^^^^^^
  File "/Users/ambikagarg/.pyenv/versions/airflow_venv/lib/python3.11/site-packages/dbt/config/profile.py", line 436, in render
    return cls.from_raw_profiles(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ambikagarg/.pyenv/versions/airflow_venv/lib/python3.11/site-packages/dbt/config/profile.py", line 401, in from_raw_profiles
    return cls.from_raw_profile_info(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ambikagarg/.pyenv/versions/airflow_venv/lib/python3.11/site-packages/dbt/config/profile.py", line 355, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ambikagarg/.pyenv/versions/airflow_venv/lib/python3.11/site-packages/dbt/config/profile.py", line 165, in _credentials_from_profile
    cls = load_plugin(typename)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ambikagarg/.pyenv/versions/airflow_venv/lib/python3.11/site-packages/dbt/adapters/factory.py", line 212, in load_plugin
    return FACTORY.load_plugin(name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ambikagarg/.pyenv/versions/airflow_venv/lib/python3.11/site-packages/dbt/adapters/factory.py", line 58, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.6_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/Users/ambikagarg/.pyenv/versions/airflow_venv/lib/python3.11/site-packages/dbt/adapters/fabric/__init__.py", line 3, in <module>
    from dbt.adapters.fabric.fabric_adapter import FabricAdapter
  File "/Users/ambikagarg/.pyenv/versions/airflow_venv/lib/python3.11/site-packages/dbt/adapters/fabric/fabric_adapter.py", line 24, in <module>
    from dbt.adapters.fabric.fabric_connection_manager import FabricConnectionManager
  File "/Users/ambikagarg/.pyenv/versions/airflow_venv/lib/python3.11/site-packages/dbt/adapters/fabric/fabric_connection_manager.py", line 10, in <module>
    import pyodbc
ImportError: dlopen(/Users/ambikagarg/.pyenv/versions/airflow_venv/lib/python3.11/site-packages/pyodbc.cpython-311-darwin.so, 0x0002): symbol not found in flat namespace '_SQLAllocHandle'

[0m23:05:46.562637 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.34775117, "process_user_time": 1.33554, "process_kernel_time": 0.244086, "process_mem_max_rss": "106807296", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:05:46.563400 [debug] [MainThread]: Command `dbt debug` failed at 23:05:46.563248 after 0.35 seconds
[0m23:05:46.563855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf84d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030aa250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f6b90>]}
[0m23:05:46.564431 [debug] [MainThread]: Flushing usage events
